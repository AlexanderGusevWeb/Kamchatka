<?php
 use UmiCms\Service;class umiObjectPropertyWrapper extends translatorWrapper {private $privateProperties = ['user_dock', 'user_settings_data', 'activate_code'];public static $showEmptyFields = false;public function translate($va8cfde6331bd59eb2ac96f8911c4b666) {return $this->translateData($va8cfde6331bd59eb2ac96f8911c4b666);}protected function translateData(iUmiObjectProperty $v1a8db4c996d8ed8289da5f957879ab94) {$v06e3d36fa30cea095545139854ad1fb9 = $v1a8db4c996d8ed8289da5f957879ab94->getField();if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {return [];}$v870b60148237c1452dfb337fdd19c314 = $v06e3d36fa30cea095545139854ad1fb9->getDataType();if ($this->isPrivateProperty($v06e3d36fa30cea095545139854ad1fb9->getName(), $v870b60148237c1452dfb337fdd19c314)) {return [];}$v2063c1608d6e0baf80249c42e2be5804 = $v1a8db4c996d8ed8289da5f957879ab94->getValue();if ($this->isEmptyValue($v2063c1608d6e0baf80249c42e2be5804)) {return [];}$v8643f8934c2da1367e8f2b996df3d117 = (int) $v06e3d36fa30cea095545139854ad1fb9->isImportant();$result = [    '@id' => $v06e3d36fa30cea095545139854ad1fb9->getId(),    '@object-id' => $v1a8db4c996d8ed8289da5f957879ab94->getObjectId(),    '@name' => $v06e3d36fa30cea095545139854ad1fb9->getName(),    '@type' => $v870b60148237c1452dfb337fdd19c314,    'title' => $v06e3d36fa30cea095545139854ad1fb9->getTitle(),    '@is-important' => "$v8643f8934c2da1367e8f2b996df3d117"   ];$v2063c1608d6e0baf80249c42e2be5804 = $this->translatePropertyValue($v06e3d36fa30cea095545139854ad1fb9, $v1a8db4c996d8ed8289da5f957879ab94, $v2063c1608d6e0baf80249c42e2be5804);if (isset($v2063c1608d6e0baf80249c42e2be5804['nodes:value'])) {$result += $v2063c1608d6e0baf80249c42e2be5804;}else {$result['value'] = $v2063c1608d6e0baf80249c42e2be5804;}if ($v870b60148237c1452dfb337fdd19c314 == 'relation' && $v06e3d36fa30cea095545139854ad1fb9->getFieldType()->getIsMultiple()) {$result['@multiple'] = 'multiple';}if ($v870b60148237c1452dfb337fdd19c314 == 'string') {$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v06e3d36fa30cea095545139854ad1fb9->getRestrictionId());if ($v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$result['@restriction'] = $v3dadfaeb46ec74762b37de11fea7605c->getClassName();}}$v52eb29c6d8ea0d3a5bb3654f49bbd7c7 = $v06e3d36fa30cea095545139854ad1fb9->getGuideId();if ($v52eb29c6d8ea0d3a5bb3654f49bbd7c7) {$result['@guide-id'] = $v52eb29c6d8ea0d3a5bb3654f49bbd7c7;$va0c391dc49c440fc9962168353cedde3 = umiObjectTypesCollection::getInstance()     ->getType($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);$v16995eef256269cfe8804ffaf770cb4b = ($va0c391dc49c440fc9962168353cedde3 instanceof iUmiObjectType) ? $va0c391dc49c440fc9962168353cedde3->isPublicGuide() : false;$result['@public-guide'] = (int) $v16995eef256269cfe8804ffaf770cb4b;}return $result;}private function translatePropertyValue(iUmiField $v06e3d36fa30cea095545139854ad1fb9, iUmiObjectProperty $v1a8db4c996d8ed8289da5f957879ab94, $v2063c1608d6e0baf80249c42e2be5804) {switch ($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case 'swf_file':    case 'file':    case 'video_file':    case 'img_file': {return $this->translateFileValue($v2063c1608d6e0baf80249c42e2be5804);}case 'symlink': {return $this->translateSymLinkValue($v2063c1608d6e0baf80249c42e2be5804);}case 'relation': {return $this->translateRelationValue($v2063c1608d6e0baf80249c42e2be5804);}case 'domain_id': {return $this->translateDomainIdValue($v2063c1608d6e0baf80249c42e2be5804);}case 'domain_id_list' : {return $this->translateDomainIdListValue($v2063c1608d6e0baf80249c42e2be5804);}case 'date': {return $this->translateDateValue($v2063c1608d6e0baf80249c42e2be5804);}case 'optioned': {return $this->translateOptionedValue($v2063c1608d6e0baf80249c42e2be5804);}default: {return $this->translateDefaultValue($v06e3d36fa30cea095545139854ad1fb9, $v1a8db4c996d8ed8289da5f957879ab94->getObjectId(), $v2063c1608d6e0baf80249c42e2be5804);}}}private function translateFileValue($v8c7dd922ad47494fc02c388e12c00eac) {if (!$v8c7dd922ad47494fc02c388e12c00eac instanceof umiFile) {return [];}$vd6fe1d0be6347b8ef2427fa629c04485 = $v8c7dd922ad47494fc02c388e12c00eac->getFilePath(true);$v2f0056df010e0231e4cca0e382df44fc = '|^' . CURRENT_WORKING_DIR . '|';$vd6fe1d0be6347b8ef2427fa629c04485 = preg_replace($v2f0056df010e0231e4cca0e382df44fc, '', $vd6fe1d0be6347b8ef2427fa629c04485);if ($v8c7dd922ad47494fc02c388e12c00eac->getIsBroken()) {return [     '@path' => '.' . $vd6fe1d0be6347b8ef2427fa629c04485,     '@is_broken' => 1,     '#value' => $vd6fe1d0be6347b8ef2427fa629c04485,    ];}$result = [    '@path' => '.' . $vd6fe1d0be6347b8ef2427fa629c04485,    '@folder' => preg_replace($v2f0056df010e0231e4cca0e382df44fc, '', $v8c7dd922ad47494fc02c388e12c00eac->getDirName()),    '@name' => $v8c7dd922ad47494fc02c388e12c00eac->getFileName(),    '@ext' => $v8c7dd922ad47494fc02c388e12c00eac->getExt(),    '@is_broken' => '0',    '#value' => $vd6fe1d0be6347b8ef2427fa629c04485,   ];if ($v8c7dd922ad47494fc02c388e12c00eac instanceof iUmiImageFile) {$result['@width'] = $v8c7dd922ad47494fc02c388e12c00eac->getWidth();$result['@height'] = $v8c7dd922ad47494fc02c388e12c00eac->getHeight();}return $result;}private function translateSymLinkValue($v91c8246e48b278ccf9e985d258de9cc9) {$result['nodes:page'] = [];foreach ($v91c8246e48b278ccf9e985d258de9cc9 as $v71860c77c6745379b0d44304d66b6a13) {$result['nodes:page'][] = $v71860c77c6745379b0d44304d66b6a13;}return $result;}private function translateRelationValue($v0f325cf81c793b7351bb1ebcd8eb7727) {$vfa5a883455df69e98c0f154ad0e5d47b = umiObjectsCollection::getInstance();$result['nodes:item'] = [];if (is_array($v0f325cf81c793b7351bb1ebcd8eb7727)) {foreach ($v0f325cf81c793b7351bb1ebcd8eb7727 as $v16b2b26000987faccb260b9d39df1269) {$result['nodes:item'][] = $vfa5a883455df69e98c0f154ad0e5d47b->getObject($v16b2b26000987faccb260b9d39df1269);}}else {$result['item'] = $vfa5a883455df69e98c0f154ad0e5d47b->getObject($v0f325cf81c793b7351bb1ebcd8eb7727);}return $result;}private function translateDomainIdValue($v72ee76c5c29383b7c9f9225c1fa4d10b) {return [    'domain' => Service::DomainCollection()     ->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b)   ];}private function translateDomainIdListValue($vad5658491d1cbf0909b631e0cc6d938d) {$vad5658491d1cbf0909b631e0cc6d938d = (array) $vad5658491d1cbf0909b631e0cc6d938d;$result['nodes:domain'] = [];$v0d771fa031fb27561ed207afa6cf9983 = Service::DomainCollection();foreach ($vad5658491d1cbf0909b631e0cc6d938d as $v72ee76c5c29383b7c9f9225c1fa4d10b) {$result['nodes:domain'][] = $v0d771fa031fb27561ed207afa6cf9983->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);}return $result;}private function translateDateValue($v5fc732311905cb27e82d67f4f6511f7f) {if (!$v5fc732311905cb27e82d67f4f6511f7f instanceof iUmiDate) {return [];}$v1ddcb92ade31c8fbd370001f9b29a7d9 = $this->getDateFormat();return [    '@formatted-date' => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate('d.m.Y H:i'),    '@unix-timestamp' => $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate('U'),    '#rfc' => ($v5fc732311905cb27e82d67f4f6511f7f->getDateTimeStamp() > 0) ? $v5fc732311905cb27e82d67f4f6511f7f->getFormattedDate($v1ddcb92ade31c8fbd370001f9b29a7d9) : ''   ];}private function getDateFormat() {$v1b299b309feb62d3291407caed9cf4fa = ['get_editable_region', 'save_editable_region'];$v8b1dc169bf460ee884fceef66c6607d6 = cmsController::getInstance();return in_array($v8b1dc169bf460ee884fceef66c6607d6->getCurrentMethod(), $v1b299b309feb62d3291407caed9cf4fa) ? false : 'r';}private function translateOptionedValue($v2063c1608d6e0baf80249c42e2be5804) {$v2063c1608d6e0baf80249c42e2be5804 = (array) $v2063c1608d6e0baf80249c42e2be5804;$vf8aea31a0fd948447674cb859137e6e7 = umiHierarchy::getInstance();$vfa5a883455df69e98c0f154ad0e5d47b = umiObjectsCollection::getInstance();$v33f4c8f48b6759818fee6a0900dd056a = [];foreach ($v2063c1608d6e0baf80249c42e2be5804 as $vef3e30e070f70244fd6578d88a6b77ac) {$v5ecf0a02e02bd528df985f4f51a5af41 = [];foreach ($vef3e30e070f70244fd6578d88a6b77ac as $vb81c10831bc6a9f860d3bda568a48266 => $v7f4435dcfb648bbff2e18576a078f9e7) {switch ($vb81c10831bc6a9f860d3bda568a48266) {case 'tree': {$v71860c77c6745379b0d44304d66b6a13 = $vf8aea31a0fd948447674cb859137e6e7->getElement($v7f4435dcfb648bbff2e18576a078f9e7);if ($v71860c77c6745379b0d44304d66b6a13 instanceof iUmiHierarchyElement) {$v5ecf0a02e02bd528df985f4f51a5af41['page'] = $v71860c77c6745379b0d44304d66b6a13;}break;}case 'rel': {$va8cfde6331bd59eb2ac96f8911c4b666 = $vfa5a883455df69e98c0f154ad0e5d47b->getObject($v7f4435dcfb648bbff2e18576a078f9e7);if ($va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {$v5ecf0a02e02bd528df985f4f51a5af41['object'] = $va8cfde6331bd59eb2ac96f8911c4b666;}break;}default: {$v5ecf0a02e02bd528df985f4f51a5af41['@' . $vb81c10831bc6a9f860d3bda568a48266] = $v7f4435dcfb648bbff2e18576a078f9e7;}}}$v33f4c8f48b6759818fee6a0900dd056a[] = $v5ecf0a02e02bd528df985f4f51a5af41;}return [    'nodes:option' => $v33f4c8f48b6759818fee6a0900dd056a   ];}private function translateDefaultValue(iUmiField $v06e3d36fa30cea095545139854ad1fb9, $v16b2b26000987faccb260b9d39df1269, $v2063c1608d6e0baf80249c42e2be5804) {$v870b60148237c1452dfb337fdd19c314 = $v06e3d36fa30cea095545139854ad1fb9->getDataType();if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {$result = [     'nodes:value' => $v2063c1608d6e0baf80249c42e2be5804    ];if ($v870b60148237c1452dfb337fdd19c314 == 'tags') {$result['combined'] = implode(', ', $v2063c1608d6e0baf80249c42e2be5804);}return $result;}$v2063c1608d6e0baf80249c42e2be5804 = xmlTranslator::executeMacroses($v2063c1608d6e0baf80249c42e2be5804, false, $v16b2b26000987faccb260b9d39df1269);if (defined('XML_PROP_VALUE_MODE') && $v870b60148237c1452dfb337fdd19c314 == 'wysiwyg' && Service::Request()->isNotAdmin()) {if (XML_PROP_VALUE_MODE == 'XML') {return [      'xml:xvalue' => "<xvalue>{$v2063c1608d6e0baf80249c42e2be5804}</xvalue>"     ];}}return [    '#value' => $v2063c1608d6e0baf80249c42e2be5804   ];}private function isPrivateProperty($vb068931cc450442b63f5b3d276ea4297, $v870b60148237c1452dfb337fdd19c314) {if (xmlTranslator::$showUnsecureFields) {return false;}return $v870b60148237c1452dfb337fdd19c314 == 'password' || in_array($vb068931cc450442b63f5b3d276ea4297, $this->privateProperties);}private function isEmptyValue($v2063c1608d6e0baf80249c42e2be5804) {if (self::$showEmptyFields || translatorWrapper::$showEmptyFields) {return false;}if (is_object($v2063c1608d6e0baf80249c42e2be5804)) {return false;}if (is_array($v2063c1608d6e0baf80249c42e2be5804)) {return empty($v2063c1608d6e0baf80249c42e2be5804);}return (string) $v2063c1608d6e0baf80249c42e2be5804 === '';}}