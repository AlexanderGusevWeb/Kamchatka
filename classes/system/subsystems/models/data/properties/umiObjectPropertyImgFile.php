<?php
 use UmiCms\Service;class umiObjectPropertyImgFile extends umiObjectProperty {protected function loadValue() {$v9b207167e5381c47682c6b4f58a623fb = [];$v945100186b119048837b9859c2c46410 = $this->field_id;$v9eb34ba60945c28231943f199eb4aacc = Service::Request()->isAdmin();$v8d777f385d3dfec8815d20f7496026dc = $this->getPropData();if ($v8d777f385d3dfec8815d20f7496026dc) {foreach ($v8d777f385d3dfec8815d20f7496026dc['text_val'] as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === null) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vb798abe6e1b1318ee36b0dcb3fb9e4d3 = new umiImageFile($v3a6d0284e743dc4a9b86f97d6dd1a3bf);if ($vb798abe6e1b1318ee36b0dcb3fb9e4d3->getIsBroken() && !$v9eb34ba60945c28231943f199eb4aacc) {continue;}$v9b207167e5381c47682c6b4f58a623fb[] = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}return $v9b207167e5381c47682c6b4f58a623fb;}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();$v80071f37861c360a27b7327e132c911a = $this->getTableName();$vac5c74b64b4b8352ef2f181affb5ac2a = "SELECT text_val FROM {$v80071f37861c360a27b7327e132c911a} WHERE obj_id = '{$this->object_id}' AND field_id = '{$v945100186b119048837b9859c2c46410}' LIMIT 1";$result = $v4717d53ebfdfea8477f780ec66151dcb->queryResult($vac5c74b64b4b8352ef2f181affb5ac2a);$result->setFetchType(IQueryResult::FETCH_ROW);foreach ($result as $vf1965a857bc285d26fe22023aa5ab50d) {$v3a6d0284e743dc4a9b86f97d6dd1a3bf = array_shift($vf1965a857bc285d26fe22023aa5ab50d);if ($v3a6d0284e743dc4a9b86f97d6dd1a3bf === null) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = self::unescapeFilePath($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$vb798abe6e1b1318ee36b0dcb3fb9e4d3 = new umiImageFile($v3a6d0284e743dc4a9b86f97d6dd1a3bf);if ($vb798abe6e1b1318ee36b0dcb3fb9e4d3->getIsBroken() && !$v9eb34ba60945c28231943f199eb4aacc) {continue;}$v9b207167e5381c47682c6b4f58a623fb[] = $vb798abe6e1b1318ee36b0dcb3fb9e4d3;}return $v9b207167e5381c47682c6b4f58a623fb;}protected function saveValue() {$this->deleteCurrentRows();if ($this->value === null) {return;}$v4717d53ebfdfea8477f780ec66151dcb = $this->getConnection();foreach ($this->value as $v3a6d0284e743dc4a9b86f97d6dd1a3bf) {if (!$v3a6d0284e743dc4a9b86f97d6dd1a3bf) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = ($v3a6d0284e743dc4a9b86f97d6dd1a3bf instanceof iUmiFile) ? $v3a6d0284e743dc4a9b86f97d6dd1a3bf->getFilePath() : (string) $v3a6d0284e743dc4a9b86f97d6dd1a3bf;if (!@is_file($v3a6d0284e743dc4a9b86f97d6dd1a3bf)) {continue;}$v3a6d0284e743dc4a9b86f97d6dd1a3bf = $v4717d53ebfdfea8477f780ec66151dcb->escape($v3a6d0284e743dc4a9b86f97d6dd1a3bf);$v80071f37861c360a27b7327e132c911a = $this->getTableName();$vac5c74b64b4b8352ef2f181affb5ac2a = "INSERT INTO {$v80071f37861c360a27b7327e132c911a} (obj_id, field_id, text_val) VALUES('{$this->object_id}', '{$this->field_id}', '{$v3a6d0284e743dc4a9b86f97d6dd1a3bf}')";$v4717d53ebfdfea8477f780ec66151dcb->query($vac5c74b64b4b8352ef2f181affb5ac2a);}}protected function isNeedToSave(array $v7f7cfde5ec586119b48911a2c75851e5) {$v0382b9fd9ef50b6a335f35e0aaaebf99 = $this->value;$v7f7cfde5ec586119b48911a2c75851e5 = array_filter($v7f7cfde5ec586119b48911a2c75851e5, function($v2063c1608d6e0baf80249c42e2be5804){$v47826cacc65c665212b821e6ff80b9b0 = ($v2063c1608d6e0baf80249c42e2be5804 instanceof iUmiImageFile) ? $v2063c1608d6e0baf80249c42e2be5804->getFilePath() : (string) $v2063c1608d6e0baf80249c42e2be5804;return @is_file($v47826cacc65c665212b821e6ff80b9b0);});switch(true) {case empty($v0382b9fd9ef50b6a335f35e0aaaebf99) && empty($v7f7cfde5ec586119b48911a2c75851e5) : {return false;}case empty($v0382b9fd9ef50b6a335f35e0aaaebf99) && !empty($v7f7cfde5ec586119b48911a2c75851e5) : {return true;}case !empty($v0382b9fd9ef50b6a335f35e0aaaebf99) && empty($v7f7cfde5ec586119b48911a2c75851e5) : {return true;}default : {$v0382b9fd9ef50b6a335f35e0aaaebf99 = array_shift($v0382b9fd9ef50b6a335f35e0aaaebf99);$v0382b9fd9ef50b6a335f35e0aaaebf99 = ($v0382b9fd9ef50b6a335f35e0aaaebf99 instanceof iUmiImageFile) ? $v0382b9fd9ef50b6a335f35e0aaaebf99->getFilePath() : (string) $v0382b9fd9ef50b6a335f35e0aaaebf99;$v7f7cfde5ec586119b48911a2c75851e5 = array_shift($v7f7cfde5ec586119b48911a2c75851e5);$v7f7cfde5ec586119b48911a2c75851e5 = ($v7f7cfde5ec586119b48911a2c75851e5 instanceof iUmiImageFile) ? $v7f7cfde5ec586119b48911a2c75851e5->getFilePath() : (string) $v7f7cfde5ec586119b48911a2c75851e5;return $v0382b9fd9ef50b6a335f35e0aaaebf99 !== $v7f7cfde5ec586119b48911a2c75851e5;}}}}