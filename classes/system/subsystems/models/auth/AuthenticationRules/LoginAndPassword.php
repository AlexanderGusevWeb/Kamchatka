<?php
 namespace UmiCms\System\Auth\AuthenticationRules;use UmiCms\System\Auth\PasswordHash\iAlgorithm;use UmiCms\System\Auth\PasswordHash\WrongAlgorithmException;use UmiCms\System\Selector\iFactory as SelectorFactory;class LoginAndPassword extends Rule {private $login;private $password;public function __construct($vd56b699830e77ba53855679cb1d252da, $v5f4dcc3b5aa765d61d8327deb882cf99, iAlgorithm $ved469618898d75b149e5c7c4b6a1c415, SelectorFactory $vdff401a605e5f6984373466cddee7287) {$this->login = $vd56b699830e77ba53855679cb1d252da;$this->password = $v5f4dcc3b5aa765d61d8327deb882cf99;$this->hashAlgorithm = $ved469618898d75b149e5c7c4b6a1c415;$this->selectorFactory = $vdff401a605e5f6984373466cddee7287;}public function validate() {$vd56b699830e77ba53855679cb1d252da = $this->getLogin();$v5f4dcc3b5aa765d61d8327deb882cf99 = $this->getPassword();$v7131c99fffb30102278db01ca3e31471 = $this->getPasswordList($v5f4dcc3b5aa765d61d8327deb882cf99);try {$v7e5aadfde0b0d3a8a9e841ac0d976572 = $this->getQueryBuilder();$v7e5aadfde0b0d3a8a9e841ac0d976572->option('or-mode')->fields('login', 'e-mail');$v7e5aadfde0b0d3a8a9e841ac0d976572->where('login')->equals($vd56b699830e77ba53855679cb1d252da);$v7e5aadfde0b0d3a8a9e841ac0d976572->where('e-mail')->equals($vd56b699830e77ba53855679cb1d252da);$v7e5aadfde0b0d3a8a9e841ac0d976572->where('password')->equals($v7131c99fffb30102278db01ca3e31471);$v7e5aadfde0b0d3a8a9e841ac0d976572->where('is_activated')->equals(true);$v7e5aadfde0b0d3a8a9e841ac0d976572->limit(0, 1);$v606f4a5eb3f20967cef8d0890d6391a9 = $v7e5aadfde0b0d3a8a9e841ac0d976572->result();}catch (\Exception $ve1671797c52e15f763380b45e841ec32) {return false;}if (umiCount($v606f4a5eb3f20967cef8d0890d6391a9) === 0) {return false;}$v710e4904889cc9c4422cd1d84dcdff13 = array_shift($v606f4a5eb3f20967cef8d0890d6391a9);return (int) $v710e4904889cc9c4422cd1d84dcdff13['id'];}private function getPasswordList($vf9ec1db33e2c5a7535d8292429031cbe) {$ved469618898d75b149e5c7c4b6a1c415 = $this->getHashAlgorithm();return [    $ved469618898d75b149e5c7c4b6a1c415::hash($vf9ec1db33e2c5a7535d8292429031cbe, $ved469618898d75b149e5c7c4b6a1c415::MD5),    $ved469618898d75b149e5c7c4b6a1c415::hash($vf9ec1db33e2c5a7535d8292429031cbe, $ved469618898d75b149e5c7c4b6a1c415::SHA256)   ];}private function getHashAlgorithm() {return $this->hashAlgorithm;}private function getLogin() {return (string) $this->login;}private function getPassword() {return (string) $this->password;}}