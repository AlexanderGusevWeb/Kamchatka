<?php
 use UmiCms\Service;class xmlImporter implements iXmlImporter {const VERSION = '2.0';const ROOT_PAGE_TYPE_ID = 3;protected $doc;protected $parser;protected $relations;protected $source_id;protected $destination_element_id = 0;protected $update_ignore = false;protected $demosite_mode = false;protected $meta = [];public   $updated_types = 0, $created_types = 0,   $updated_languages = 0, $created_languages = 0,   $updated_domains = 0, $created_domains = 0,   $updated_domain_mirrors = 0, $created_domain_mirrors = 0,   $updated_templates = 0, $created_templates = 0,   $updated_objects = 0, $created_objects = 0, $deleted_objects = 0,   $updated_elements = 0, $created_elements = 0, $deleted_elements = 0,   $updated_entities = 0, $created_entities = 0,   $copied_files = 0,   $updated_relations = 0,   $created_restrictions = 0,   $created_registry_items = 0,   $created_permissions = 0,   $created_field_types = 0,   $created_dirs = 0,   $import_errors = 0;public $useI18n = true;public $filesSource = false;public $ignoreParentGroups = true;public $auto_guide_creation = false;public $renameFiles = false;protected $import_log = [];protected $imported_elements = [];private $rootDirPath;private $eventsEnabled = true;public function __construct($v7c95caafbd5e4b5db3977617a0498de6 = false) {if ($v7c95caafbd5e4b5db3977617a0498de6) {$this->meta['source-name'] = $v7c95caafbd5e4b5db3977617a0498de6;}$this->doc = new DomDocument('1.0', 'utf-8');$this->relations = umiImportRelations::getInstance();}public function setRootDirPath($vd6fe1d0be6347b8ef2427fa629c04485) {if (!is_string($vd6fe1d0be6347b8ef2427fa629c04485) || !is_dir($vd6fe1d0be6347b8ef2427fa629c04485)) {throw new coreException('Incorrect root directory path given');}$this->rootDirPath = $vd6fe1d0be6347b8ef2427fa629c04485;}public function getCreatedEntityCount() {return    $this->created_types +    $this->created_languages +    $this->created_domains +    $this->created_domain_mirrors +    $this->created_templates +    $this->created_objects +    $this->created_elements +    $this->created_restrictions +    $this->created_registry_items +    $this->created_permissions +    $this->created_field_types +    $this->created_dirs +    $this->created_entities;}public function getUpdatedEntityCount() {return    $this->updated_types +    $this->updated_languages +    $this->updated_domains +    $this->updated_domain_mirrors +    $this->updated_templates +    $this->updated_objects +    $this->updated_elements +    $this->updated_relations +    $this->updated_entities;}public function getDeletedEntityCount() {return $this->deleted_elements;}public function getErrorCount() {return $this->import_errors;}public function setUpdateIgnoreMode($v6d720e694d23443f7d47afa49f08cde9 = true) {$this->update_ignore = (bool) $v6d720e694d23443f7d47afa49f08cde9;}public function setAutoGuideCreation($vae1a55c0b778947dc65e0150c16befba = false) {$this->auto_guide_creation = (bool) $vae1a55c0b778947dc65e0150c16befba;}public function setRenameFiles($v82e493c80beeab7a6e841aa86ea2c6ad = false) {$this->renameFiles = (bool) $v82e493c80beeab7a6e841aa86ea2c6ad;}public function setDemositeMode($v71373c727e8a061c8b9b6ae59d60f656 = true) {$this->demosite_mode = $v71373c727e8a061c8b9b6ae59d60f656;}public function loadXmlString($v58309fbfe87fa90ec9f4b9d78ead9d77) {return secure_load_dom_document($v58309fbfe87fa90ec9f4b9d78ead9d77, $this->doc);}protected function getLabel($i18n, $vd6fe1d0be6347b8ef2427fa629c04485 = false) {$vd304ba20e96d87411588eeabac850e34 = false;if ($this->useI18n) {$args = func_get_args();$vd304ba20e96d87411588eeabac850e34 = call_user_func_array('getLabel', $args);}if (!$vd304ba20e96d87411588eeabac850e34 || $vd304ba20e96d87411588eeabac850e34 == $i18n) {$vd304ba20e96d87411588eeabac850e34 = str_replace('label-', '', $i18n);$vd304ba20e96d87411588eeabac850e34 = preg_replace('/(.*?)-[m,f,n]+$/', '$1', $vd304ba20e96d87411588eeabac850e34);$vd304ba20e96d87411588eeabac850e34 = str_replace('-', ' ', $vd304ba20e96d87411588eeabac850e34);}return $vd304ba20e96d87411588eeabac850e34;}public function loadXmlFile($vd6fe1d0be6347b8ef2427fa629c04485) {if (!is_file($vd6fe1d0be6347b8ef2427fa629c04485)) {throw new publicException($this->getLabel('label-cannot-read-file') . ' ' . $vd6fe1d0be6347b8ef2427fa629c04485);}return secure_load_dom_document(file_get_contents($vd6fe1d0be6347b8ef2427fa629c04485), $this->doc);}public function loadXmlDocument(DOMDocument $v9a09b4dfda82e3e665e31092d1c3ec8d) {$this->doc = $v9a09b4dfda82e3e665e31092d1c3ec8d;}public function setDestinationElement($v8e2dcfd7e7e24b1ca76c1193f645902b) {if ($v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b->getId();return true;}if (umiHierarchy::getInstance()->getElement($v8e2dcfd7e7e24b1ca76c1193f645902b, true, true) instanceof iUmiHierarchyElement) {$this->destination_element_id = $v8e2dcfd7e7e24b1ca76c1193f645902b;return true;}return false;}public function execute() {$ve2ff5259ecfb79d2ef7d38863e36d905 = cmsController::$IGNORE_MICROCACHE;$v148ac41d5f2dfcc86b238ef0ad0e5940 = umiObjectProperty::$IGNORE_FILTER_INPUT_STRING;cmsController::$IGNORE_MICROCACHE = true;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = true;$v2245023265ae4cf87d02c8b6ba991139 = mainConfiguration::getInstance();if (!defined('DISABLE_SEARCH_REINDEX') && !$v2245023265ae4cf87d02c8b6ba991139->get('kernel', 'import-auto-index')) {define('DISABLE_SEARCH_REINDEX', 1);}$v281b9dea68869a314a221d7a574fda94 = umiObjectProperty::$USE_FORCE_OBJECTS_CREATION;umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;if ($this->auto_guide_creation) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}$this->init();$this->useI18n = false;$this->importDirs();if ($this->filesSource) {$this->importFiles();}$this->useI18n = true;$this->importRegistry();$this->importLangs();$this->importDomains();$this->importTemplates();$this->importDataTypes();$this->importTypes();$this->importObjects();$this->importEntities();$this->importElements();$this->importRelations();$this->importOptions();$this->importRestrictions();$this->importPermissions();$this->importHierarchy();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = $v281b9dea68869a314a221d7a574fda94;cmsController::$IGNORE_MICROCACHE = $ve2ff5259ecfb79d2ef7d38863e36d905;umiObjectProperty::$IGNORE_FILTER_INPUT_STRING = $v148ac41d5f2dfcc86b238ef0ad0e5940;}public function demolish() {$this->init();$vdc1d71bbb5c4d2a5e936db79ef10c19f = Service::UmiDumpDemolisherExecutor()    ->setRootPath($this->getRootDirPath())    ->setSourceId($this->source_id)    ->run($this->parser);foreach ($vdc1d71bbb5c4d2a5e936db79ef10c19f as $v78e731027d8fd50ed642340b7c9a63b3) {$this->writeLog($v78e731027d8fd50ed642340b7c9a63b3);}return $this;}public function setFilesSource($vd2c10d5f8f2397b7c8ed983609e71e27) {if (!is_dir($vd2c10d5f8f2397b7c8ed983609e71e27)) {throw new coreException($this->getLabel('label-cannot-find-files-source'));}$this->filesSource = $vd2c10d5f8f2397b7c8ed983609e71e27;}public function setIgnoreParentGroups($va0913828f00eefe560bcf007c7ae015a) {$this->ignoreParentGroups = (bool) $va0913828f00eefe560bcf007c7ae015a;}protected function init() {$this->parser = new DOMXPath($this->doc);$v22a3c602451fa234213b052a9190ea4e = $this->parser->evaluate('/umidump/@version');$v2af72f100c356273d46284f6fd1dfc08 = $v22a3c602451fa234213b052a9190ea4e->length ? $v22a3c602451fa234213b052a9190ea4e->item(0)->nodeValue : '';if ($v2af72f100c356273d46284f6fd1dfc08 != self::VERSION) {throw new publicException($this->getLabel('label-unknown-umidump-version'));}$this->parseMetaData();$this->source_id = $this->relations->getSourceId($this->meta['source-name']);if (!$this->source_id) {$this->source_id = $this->relations->addNewSource($this->meta['source-name']);}}protected function reportError($vcb5e100e5a9a3e7f6d1fd97512215282) {$this->import_errors++;if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) {Service::Response()     ->getCliBuffer()     ->push($vcb5e100e5a9a3e7f6d1fd97512215282 . PHP_EOL);}else {$this->import_log[] = "<font style='color:red''>" . $vcb5e100e5a9a3e7f6d1fd97512215282 . '</font>';}}protected function writeLog($v78e731027d8fd50ed642340b7c9a63b3) {if (defined('UMICMS_CLI_MODE') && UMICMS_CLI_MODE) {Service::Response()     ->getCliBuffer()     ->push($v78e731027d8fd50ed642340b7c9a63b3 . PHP_EOL);}else {$this->import_log[] = $v78e731027d8fd50ed642340b7c9a63b3;}}public function getImportLog() {return $this->import_log;}protected function parseMetaData() {$ve9a23cbc455158951716b440c3d165e0 = $this->meta;$vf418892c852ccf5c86998e89045e8063 = $this->parser->evaluate('/umidump/meta/site-name');$ve9a23cbc455158951716b440c3d165e0['site-name'] = $vf418892c852ccf5c86998e89045e8063->length ? $vf418892c852ccf5c86998e89045e8063->item(0)->nodeValue : '';$vad5f82e879a9c5d6b5b442eb37e50551 = $this->parser->evaluate('/umidump/meta/domain');$ve9a23cbc455158951716b440c3d165e0['domain'] = $vad5f82e879a9c5d6b5b442eb37e50551->length ? $vad5f82e879a9c5d6b5b442eb37e50551->item(0)->nodeValue : '';$v7572559ca86e781ba8fe8073a0b725c6 = $this->parser->evaluate('/umidump/meta/lang');$ve9a23cbc455158951716b440c3d165e0['lang'] = $v7572559ca86e781ba8fe8073a0b725c6->length ? $v7572559ca86e781ba8fe8073a0b725c6->item(0)->nodeValue : '';if (!isset($ve9a23cbc455158951716b440c3d165e0['source-name'])) {$v7c95caafbd5e4b5db3977617a0498de6 = $this->parser->evaluate('/umidump/meta/source-name');$ve9a23cbc455158951716b440c3d165e0['source-name'] = $v7c95caafbd5e4b5db3977617a0498de6->length ? $v7c95caafbd5e4b5db3977617a0498de6->item(0)->nodeValue : md5($ve9a23cbc455158951716b440c3d165e0['domain']);}$v87a3cb5c3554b2d9d8a1a773ad0936be = $this->parser->evaluate('/umidump/meta/generate-time/timestamp');$ve9a23cbc455158951716b440c3d165e0['generated'] = $v87a3cb5c3554b2d9d8a1a773ad0936be->length ? $v87a3cb5c3554b2d9d8a1a773ad0936be->item(0)->nodeValue : '';$this->meta = $ve9a23cbc455158951716b440c3d165e0;}protected function importHierarchyType($v1d9a567b68f4f1c145ce39c7b8e0d944, $v67afbce1d0691c11372d1432743b44c7, $vaebc29d3eabe99fe70f6a52ea1468612) {$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchyTypesCollection::getInstance();$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v1d9a567b68f4f1c145ce39c7b8e0d944, $v67afbce1d0691c11372d1432743b44c7);if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$vdb6d9b451b818ccc9a449383f2f0c450->addType($v1d9a567b68f4f1c145ce39c7b8e0d944, $vaebc29d3eabe99fe70f6a52ea1468612, $v67afbce1d0691c11372d1432743b44c7);$v89b0b9deff65f8b9cd1f71bc74ce36ba = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeByName($v1d9a567b68f4f1c145ce39c7b8e0d944, $v67afbce1d0691c11372d1432743b44c7);}if (!$v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {throw new coreException($this->getLabel('label-cannot-create-hierarchy-type') . "{$v1d9a567b68f4f1c145ce39c7b8e0d944}/{$v67afbce1d0691c11372d1432743b44c7} ({$vaebc29d3eabe99fe70f6a52ea1468612})");}return $v89b0b9deff65f8b9cd1f71bc74ce36ba;}protected function importTypes() {$vd14a8022b085f9ef19d479cbdd581127 = $this->parser->evaluate('/umidump/types/type');foreach ($vd14a8022b085f9ef19d479cbdd581127 as $v8d90d57cd5d62bf377f6f8bc0cffc325) {$this->importType($v8d90d57cd5d62bf377f6f8bc0cffc325);}}protected function importType(DOMElement $v8d90d57cd5d62bf377f6f8bc0cffc325) {$v3bd920688a19a611654416dbea871efa = $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('id');$v84aa805a9d919179ab8f8b24376e2ed7 = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('title') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('title') : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-type') . " \"{$v84aa805a9d919179ab8f8b24376e2ed7}\" " . $this->getLabel('label-with-empty-id'));return false;}$vc02811e4c4fdd0b3549131ca8a2c74d1 = $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('parent-id');$va8d6fa79ab1177f254f679f9fe648a3e = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('guide') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('guide') : null;$v16995eef256269cfe8804ffaf770cb4b = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('public') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('public') : null;$v73b8754d45983f35756b157ea439de8c = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('locked') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('locked') : null;$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('guid') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('guid') : null;$v72ee76c5c29383b7c9f9225c1fa4d10b = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('domain-id') ? $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('domain-id') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v8e13be5db2b5a81e63421c40a188f433 = false;if ($v1e0ca5b1252f1f6b1e0ac91be7e7219e !== null) {$v8e13be5db2b5a81e63421c40a188f433 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($v8e13be5db2b5a81e63421c40a188f433 && $v8e13be5db2b5a81e63421c40a188f433 != $this->relations->getNewTypeIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa)) {$this->relations->setTypeIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v8e13be5db2b5a81e63421c40a188f433);}}if (!$v8e13be5db2b5a81e63421c40a188f433) {$v8e13be5db2b5a81e63421c40a188f433 = $this->relations->getNewTypeIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);}if ($v8e13be5db2b5a81e63421c40a188f433 && $this->update_ignore) {$this->writeLog($this->getLabel('label-datatype') . ' "' . $v84aa805a9d919179ab8f8b24376e2ed7 . '" ' . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getType($v8e13be5db2b5a81e63421c40a188f433);}if (!$v8e13be5db2b5a81e63421c40a188f433) {$vbb719ffca4584f38b35d3ca51f3b2a33 = (trim($vc02811e4c4fdd0b3549131ca8a2c74d1, '{}') == 'root-pages-type') ? $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-pages-type') : $this->relations->getNewTypeIdRelation($this->source_id, $vc02811e4c4fdd0b3549131ca8a2c74d1);if ($v84aa805a9d919179ab8f8b24376e2ed7 === null) {$v84aa805a9d919179ab8f8b24376e2ed7 = 'Type #' . $v3bd920688a19a611654416dbea871efa;}$v80af267a240b65301a7264ed9ba073a0 = $this->parser->evaluate('base', $v8d90d57cd5d62bf377f6f8bc0cffc325);$vf6dc8d34a08356ab7293e6fe5f954634 = $v80af267a240b65301a7264ed9ba073a0->length ? $v80af267a240b65301a7264ed9ba073a0->item(0) : false;$v1d9a567b68f4f1c145ce39c7b8e0d944 = $vf6dc8d34a08356ab7293e6fe5f954634 ? $vf6dc8d34a08356ab7293e6fe5f954634->getAttribute('module') : false;$v67afbce1d0691c11372d1432743b44c7 = $vf6dc8d34a08356ab7293e6fe5f954634 ? $vf6dc8d34a08356ab7293e6fe5f954634->getAttribute('method') : false;$vaebc29d3eabe99fe70f6a52ea1468612 = $vf6dc8d34a08356ab7293e6fe5f954634 ? $vf6dc8d34a08356ab7293e6fe5f954634->nodeValue : false;$v89b0b9deff65f8b9cd1f71bc74ce36ba = false;if ($v1d9a567b68f4f1c145ce39c7b8e0d944) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = $this->importHierarchyType($v1d9a567b68f4f1c145ce39c7b8e0d944, $v67afbce1d0691c11372d1432743b44c7, $vaebc29d3eabe99fe70f6a52ea1468612);$v1745bd73ea2a779bab75968381aa4146 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());$v152163c4320bc49594f3ac21600886b1 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v1745bd73ea2a779bab75968381aa4146);if (trim($vc02811e4c4fdd0b3549131ca8a2c74d1, '{}') == 'root-pages-type' && $v152163c4320bc49594f3ac21600886b1 instanceof iUmiObjectType) {$v8e13be5db2b5a81e63421c40a188f433 = $v152163c4320bc49594f3ac21600886b1->getId();}elseif (!$vbb719ffca4584f38b35d3ca51f3b2a33 && $v152163c4320bc49594f3ac21600886b1 instanceof iUmiObjectType) {$vbb719ffca4584f38b35d3ca51f3b2a33 = $v152163c4320bc49594f3ac21600886b1->getId();}}if (!$v8e13be5db2b5a81e63421c40a188f433) {$v8e13be5db2b5a81e63421c40a188f433 = $vdb6d9b451b818ccc9a449383f2f0c450->addType((int) $vbb719ffca4584f38b35d3ca51f3b2a33, trim($v84aa805a9d919179ab8f8b24376e2ed7), false, $this->ignoreParentGroups);}$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v8e13be5db2b5a81e63421c40a188f433);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba) {$v599dcce2998a6b40b1e38e8c6006cb0a->setHierarchyTypeId($v89b0b9deff65f8b9cd1f71bc74ce36ba->getId());}$ve2fa538867c3830a859a5b17ab24644b = true;if ($v1e0ca5b1252f1f6b1e0ac91be7e7219e !== null) {$vdb6d9b451b818ccc9a449383f2f0c450->getType($v8e13be5db2b5a81e63421c40a188f433)->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);}$this->relations->setTypeIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v8e13be5db2b5a81e63421c40a188f433);}$v599dcce2998a6b40b1e38e8c6006cb0a = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v8e13be5db2b5a81e63421c40a188f433);$v86dce043678952b27d5b27a5296f020c = $v8d90d57cd5d62bf377f6f8bc0cffc325->hasAttribute('install-only') ? (bool) $v8d90d57cd5d62bf377f6f8bc0cffc325->getAttribute('install-only') : false;if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiObjectType) {$this->reportError($this->getLabel('label-cannot-detect-type') . $this->getLabel('label-datatype') . "{$v84aa805a9d919179ab8f8b24376e2ed7} ({$v3bd920688a19a611654416dbea871efa})");return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if ($v84aa805a9d919179ab8f8b24376e2ed7 !== null) {$v599dcce2998a6b40b1e38e8c6006cb0a->setName(trim($v84aa805a9d919179ab8f8b24376e2ed7));}if ($v16995eef256269cfe8804ffaf770cb4b !== null) {$v599dcce2998a6b40b1e38e8c6006cb0a->setIsPublic($v16995eef256269cfe8804ffaf770cb4b == 'public' || $v16995eef256269cfe8804ffaf770cb4b == '1');}if ($va8d6fa79ab1177f254f679f9fe648a3e !== null) {$v599dcce2998a6b40b1e38e8c6006cb0a->setIsGuidable($va8d6fa79ab1177f254f679f9fe648a3e == 'guide' || $va8d6fa79ab1177f254f679f9fe648a3e == '1');}if ($v73b8754d45983f35756b157ea439de8c !== null) {$v599dcce2998a6b40b1e38e8c6006cb0a->setIsLocked($v73b8754d45983f35756b157ea439de8c == 'locked' || $v73b8754d45983f35756b157ea439de8c == '1');}if ($v1e0ca5b1252f1f6b1e0ac91be7e7219e !== null) {$v599dcce2998a6b40b1e38e8c6006cb0a->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);}if ($v72ee76c5c29383b7c9f9225c1fa4d10b !== null) {$v32a9d3c9a4b1449499e182e90d04fcc9 = $v72ee76c5c29383b7c9f9225c1fa4d10b;$v1c043be0eed6949c174fcf4359f7c601 = $this->relations->getNewDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9);if (is_int($v1c043be0eed6949c174fcf4359f7c601)) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $v1c043be0eed6949c174fcf4359f7c601;}elseif(Service::DomainCollection()->isExists($v32a9d3c9a4b1449499e182e90d04fcc9)) {$this->relations->setDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9, $v32a9d3c9a4b1449499e182e90d04fcc9);$v72ee76c5c29383b7c9f9225c1fa4d10b = $v32a9d3c9a4b1449499e182e90d04fcc9;}else {$v72ee76c5c29383b7c9f9225c1fa4d10b = null;}$v599dcce2998a6b40b1e38e8c6006cb0a->setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);}$v599dcce2998a6b40b1e38e8c6006cb0a->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_types++;$this->writeLog($this->getLabel('label-datatype') . ' "' . $v84aa805a9d919179ab8f8b24376e2ed7 . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-m'));}else {$this->updated_types++;$this->writeLog($this->getLabel('label-datatype') . ' "' . $v84aa805a9d919179ab8f8b24376e2ed7 . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-m'));}$this->importTypeGroups($v599dcce2998a6b40b1e38e8c6006cb0a, $v8d90d57cd5d62bf377f6f8bc0cffc325);return $v599dcce2998a6b40b1e38e8c6006cb0a;}protected function importTypeGroups(iUmiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $v8d90d57cd5d62bf377f6f8bc0cffc325) {$v1471e4e05a4db95d353cc867fe317314 = $this->parser->evaluate('fieldgroups/group', $v8d90d57cd5d62bf377f6f8bc0cffc325);foreach ($v1471e4e05a4db95d353cc867fe317314 as $va675fe51a42ad86a342be910e8266321) {$this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $va675fe51a42ad86a342be910e8266321);}}protected function importTypeGroup(iUmiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a, DOMElement $va675fe51a42ad86a342be910e8266321, $vbfb6687263728645c3eb7b6702c2aea3 = true) {$v9d73e9e6a1284959266f17444cfbdee4 = $va675fe51a42ad86a342be910e8266321->getAttribute('name');if (!$v9d73e9e6a1284959266f17444cfbdee4) {return false;}$vb4fcf5af9503236ccffd6c8d7829a8ee = self::translateName($v9d73e9e6a1284959266f17444cfbdee4);$vd5d3db1765287eef77d7927cc956f50a = $va675fe51a42ad86a342be910e8266321->hasAttribute('title') ? $va675fe51a42ad86a342be910e8266321->getAttribute('title') : null;$v19fad0416b4b101ab72faccf4c323024 = $va675fe51a42ad86a342be910e8266321->hasAttribute('visible') ? $va675fe51a42ad86a342be910e8266321->getAttribute('visible') : null;$v73b8754d45983f35756b157ea439de8c = $va675fe51a42ad86a342be910e8266321->hasAttribute('locked') ? $va675fe51a42ad86a342be910e8266321->getAttribute('locked') : null;$v367e854225a0810977297b3bedb2f309 = $va675fe51a42ad86a342be910e8266321->hasAttribute('active') ? $va675fe51a42ad86a342be910e8266321->getAttribute('active') : null;$v44856ea782bd1fdec7732eaafe9f930c = $va675fe51a42ad86a342be910e8266321->getElementsByTagName('tip');$v923b48718e53ddb14a8d9f3442835a8f = ($v44856ea782bd1fdec7732eaafe9f930c->length > 0 ? $v44856ea782bd1fdec7732eaafe9f930c->item(0)->nodeValue : null);$vdb0f6f37ebeb6ea09489124345af2a45 = null;$v47db2588331bbe530c80dd001fc60aed = $this->relations->getNewGroupId($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v9d73e9e6a1284959266f17444cfbdee4);if ($v47db2588331bbe530c80dd001fc60aed) {$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v47db2588331bbe530c80dd001fc60aed, true);}if (!$v47db2588331bbe530c80dd001fc60aed) {$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroupByName($vb4fcf5af9503236ccffd6c8d7829a8ee, true);if ($vdb0f6f37ebeb6ea09489124345af2a45) {$this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v9d73e9e6a1284959266f17444cfbdee4, $vdb0f6f37ebeb6ea09489124345af2a45->getId());}}if ($vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {$v6aec3d4eded5bfd0fe1b9e651fb4d3b2 = $this->getChildrenTypeGroupIdList($v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $vb4fcf5af9503236ccffd6c8d7829a8ee);foreach ($v6aec3d4eded5bfd0fe1b9e651fb4d3b2 as $vdf45b30e5e028f01ccbfbb1c3c4ae64a => $v5fd192b755b0b0acc7b4b12de7bd7dd0) {if (!$this->relations->getNewGroupId($this->source_id, $vdf45b30e5e028f01ccbfbb1c3c4ae64a, $v5fd192b755b0b0acc7b4b12de7bd7dd0)) {unset($v6aec3d4eded5bfd0fe1b9e651fb4d3b2[$vdf45b30e5e028f01ccbfbb1c3c4ae64a]);}}}else {if ($vd5d3db1765287eef77d7927cc956f50a === null) {$vd5d3db1765287eef77d7927cc956f50a = 'Group #' . $v9d73e9e6a1284959266f17444cfbdee4;}$v47db2588331bbe530c80dd001fc60aed = $v599dcce2998a6b40b1e38e8c6006cb0a->addFieldsGroup($vb4fcf5af9503236ccffd6c8d7829a8ee, trim($vd5d3db1765287eef77d7927cc956f50a), true, false, $v923b48718e53ddb14a8d9f3442835a8f);$this->relations->setGroupIdRelation($this->source_id, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v9d73e9e6a1284959266f17444cfbdee4, $v47db2588331bbe530c80dd001fc60aed);$vdb0f6f37ebeb6ea09489124345af2a45 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldsGroup($v47db2588331bbe530c80dd001fc60aed, true);$v6aec3d4eded5bfd0fe1b9e651fb4d3b2 = $this->getChildrenTypeGroupIdList($v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $vb4fcf5af9503236ccffd6c8d7829a8ee);foreach ($v6aec3d4eded5bfd0fe1b9e651fb4d3b2 as $vdf45b30e5e028f01ccbfbb1c3c4ae64a => $v1daa6d42321065ad1b60ced659f62d2a) {$this->relations->setTypeIdRelation($this->source_id, $vdf45b30e5e028f01ccbfbb1c3c4ae64a, $vdf45b30e5e028f01ccbfbb1c3c4ae64a);$this->relations->setGroupIdRelation(      $this->source_id, $vdf45b30e5e028f01ccbfbb1c3c4ae64a, $v9d73e9e6a1284959266f17444cfbdee4, $v1daa6d42321065ad1b60ced659f62d2a     );}}if ($vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {$v6aec3d4eded5bfd0fe1b9e651fb4d3b2[$v599dcce2998a6b40b1e38e8c6006cb0a->getId()] = $vdb0f6f37ebeb6ea09489124345af2a45->getId();}if (empty($v6aec3d4eded5bfd0fe1b9e651fb4d3b2)) {$this->reportError($this->getLabel('label-cannot-import-group') . "{$v9d73e9e6a1284959266f17444cfbdee4}:" . $this->getLabel('label-cannot-detect-group'));return false;}$v8d51528cb018f443ee726b3b85da495b = umiObjectTypesCollection::getInstance();foreach ($v6aec3d4eded5bfd0fe1b9e651fb4d3b2 as $v5f694956811487225d15e973ca38fbab => $v137d48a7b87bf35cf83c0a75fcb7cd1a) {$v9398416fb8dba5db508261e628d7fb84 = $v8d51528cb018f443ee726b3b85da495b->getType($v5f694956811487225d15e973ca38fbab);if (!$v9398416fb8dba5db508261e628d7fb84 instanceof iUmiObjectType) {continue;}$v22fc2bf44a9332c31b099fed5432c44f = true;$vc0a58df1973a98087052b0c7afcb5a4a = $v9398416fb8dba5db508261e628d7fb84->getFieldsGroup($v137d48a7b87bf35cf83c0a75fcb7cd1a, $v22fc2bf44a9332c31b099fed5432c44f);if (!$vc0a58df1973a98087052b0c7afcb5a4a instanceof iUmiFieldsGroup) {$v8d51528cb018f443ee726b3b85da495b->unloadType($v5f694956811487225d15e973ca38fbab);continue;}if ($vd5d3db1765287eef77d7927cc956f50a !== null) {$vc0a58df1973a98087052b0c7afcb5a4a->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));}if ($v19fad0416b4b101ab72faccf4c323024 !== null) {$vc0a58df1973a98087052b0c7afcb5a4a->setIsVisible($v19fad0416b4b101ab72faccf4c323024 == 'visible' || $v19fad0416b4b101ab72faccf4c323024 == '1');}if ($v367e854225a0810977297b3bedb2f309 !== null) {$vc0a58df1973a98087052b0c7afcb5a4a->setIsActive($v367e854225a0810977297b3bedb2f309 == 'active' || $v367e854225a0810977297b3bedb2f309 == '1');}if ($v73b8754d45983f35756b157ea439de8c !== null) {$vc0a58df1973a98087052b0c7afcb5a4a->setIsLocked($v73b8754d45983f35756b157ea439de8c == 'locked' || $v73b8754d45983f35756b157ea439de8c == '1');}if ($v923b48718e53ddb14a8d9f3442835a8f !== null) {$vc0a58df1973a98087052b0c7afcb5a4a->setTip($v923b48718e53ddb14a8d9f3442835a8f);}$vc0a58df1973a98087052b0c7afcb5a4a->commit();if ($vbfb6687263728645c3eb7b6702c2aea3) {$this->importGroupFields($vc0a58df1973a98087052b0c7afcb5a4a, $va675fe51a42ad86a342be910e8266321);}$v8d51528cb018f443ee726b3b85da495b->unloadType($v5f694956811487225d15e973ca38fbab);}return $v6aec3d4eded5bfd0fe1b9e651fb4d3b2;}protected function getChildrenTypeGroupIdList($va08f2aee9de301619776deb6fee83e50, $va2b861d0e7719d9108522aacfd4181bc) {$v8988aed53b6f4f4932b092de09f31980 = umiObjectTypesCollection::getInstance();$va3af0f9ca075e7f0da41533bd46136bb = $v8988aed53b6f4f4932b092de09f31980->getSubTypesList($va08f2aee9de301619776deb6fee83e50);$v2c488f5b9016f0928cffe9aa8d416574 = [];foreach ($va3af0f9ca075e7f0da41533bd46136bb as $vdf45b30e5e028f01ccbfbb1c3c4ae64a) {$v9398416fb8dba5db508261e628d7fb84 = $v8988aed53b6f4f4932b092de09f31980->getType($vdf45b30e5e028f01ccbfbb1c3c4ae64a);if (!$v9398416fb8dba5db508261e628d7fb84 instanceof iUmiObjectType) {continue;}$v22fc2bf44a9332c31b099fed5432c44f = true;$v25640a4f59aebff062124da30d2423e1 = $v9398416fb8dba5db508261e628d7fb84->getFieldsGroupByName($va2b861d0e7719d9108522aacfd4181bc, $v22fc2bf44a9332c31b099fed5432c44f);$v8988aed53b6f4f4932b092de09f31980->unloadType($v9398416fb8dba5db508261e628d7fb84->getId());if (!$v25640a4f59aebff062124da30d2423e1 instanceof iUmiFieldsGroup) {continue;}$v2c488f5b9016f0928cffe9aa8d416574[$vdf45b30e5e028f01ccbfbb1c3c4ae64a] = $v25640a4f59aebff062124da30d2423e1->getId();unset($v25640a4f59aebff062124da30d2423e1);}return $v2c488f5b9016f0928cffe9aa8d416574;}protected function importGroupFields(iUmiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $va675fe51a42ad86a342be910e8266321) {$vd05b6ed7d2345020440df396d6da7f73 = $this->parser->evaluate('field', $va675fe51a42ad86a342be910e8266321);foreach ($vd05b6ed7d2345020440df396d6da7f73 as $v89a2007e7c15e80c35f21ea4a4540700) {$this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $v89a2007e7c15e80c35f21ea4a4540700);}}protected function getFieldByName(iUmiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, $vb068931cc450442b63f5b3d276ea4297) {$v69fe4aec8073954bf273e3113edd24cf = $vdb0f6f37ebeb6ea09489124345af2a45->getFields();foreach ($v69fe4aec8073954bf273e3113edd24cf as $v06e3d36fa30cea095545139854ad1fb9) {if ($v06e3d36fa30cea095545139854ad1fb9->getName() === $vb068931cc450442b63f5b3d276ea4297) {return $v06e3d36fa30cea095545139854ad1fb9;}}return false;}protected function importDataTypes() {$vdbbcaf65ba3694e4c2e04a2e53e50ba5 = $this->parser->evaluate('/umidump/datatypes/datatype');foreach ($vdbbcaf65ba3694e4c2e04a2e53e50ba5 as $v8e426de3bfa4efd7556ed624ebae4c29) {$this->importFieldType($v8e426de3bfa4efd7556ed624ebae4c29);}}protected function importFieldType(DOMElement $v8e426de3bfa4efd7556ed624ebae4c29) {$vb068931cc450442b63f5b3d276ea4297 = $v8e426de3bfa4efd7556ed624ebae4c29->getAttribute('name');$v870b60148237c1452dfb337fdd19c314 = $v8e426de3bfa4efd7556ed624ebae4c29->getAttribute('data-type');$vce495ab8d79db0d37413d8e95b54e606 = $v8e426de3bfa4efd7556ed624ebae4c29->getAttribute('multiple') == 1 || $v8e426de3bfa4efd7556ed624ebae4c29->getAttribute('multiple') == 'multiple';if (!$v870b60148237c1452dfb337fdd19c314) {return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v833750ac635fcc57dc33ecafe365f9a7 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v870b60148237c1452dfb337fdd19c314, $vce495ab8d79db0d37413d8e95b54e606);$ve2fa538867c3830a859a5b17ab24644b = false;if (!$v833750ac635fcc57dc33ecafe365f9a7 instanceof iUmiFieldType) {$ve2aeb4e882d60b1eb4b7c8cd97986a28 = $vdb6d9b451b818ccc9a449383f2f0c450->addFieldType($vb068931cc450442b63f5b3d276ea4297, $v870b60148237c1452dfb337fdd19c314);$v833750ac635fcc57dc33ecafe365f9a7 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldType($ve2aeb4e882d60b1eb4b7c8cd97986a28);$v833750ac635fcc57dc33ecafe365f9a7->setIsMultiple($vce495ab8d79db0d37413d8e95b54e606);$v833750ac635fcc57dc33ecafe365f9a7->commit();$ve2fa538867c3830a859a5b17ab24644b = true;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_field_types++;$this->writeLog($this->getLabel('label-field-type') . '"' . $v833750ac635fcc57dc33ecafe365f9a7->getName() . '"' . $this->getLabel('label-has-been-created-m'));}return $v833750ac635fcc57dc33ecafe365f9a7;}public function getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a) {$v525fb5c69c6f5250b26f0c4fa60f7d61 = getLabel('label-catalog-for-field') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\"";$vdb6d9b451b818ccc9a449383f2f0c450 = umiObjectTypesCollection::getInstance();$va08f2aee9de301619776deb6fee83e50 = $vdb6d9b451b818ccc9a449383f2f0c450->getTypeIdByGUID('root-guides-type');$v3285df347560b9aaa13f5a74676f815b = $vdb6d9b451b818ccc9a449383f2f0c450->getChildTypeIds($va08f2aee9de301619776deb6fee83e50);foreach ($v3285df347560b9aaa13f5a74676f815b as $v788855b190dde82f9c1e11700c276e14) {$vefaed59f8aaebf1f7bde99635273bd6d = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v788855b190dde82f9c1e11700c276e14);$vca6a5c32f4e5480cb9eac519ed3a43d3 = $vefaed59f8aaebf1f7bde99635273bd6d->getName();if ($vca6a5c32f4e5480cb9eac519ed3a43d3 == $v525fb5c69c6f5250b26f0c4fa60f7d61) {$vefaed59f8aaebf1f7bde99635273bd6d->setIsGuidable(true);return $v788855b190dde82f9c1e11700c276e14;}}$v52eb29c6d8ea0d3a5bb3654f49bbd7c7 = $vdb6d9b451b818ccc9a449383f2f0c450->addType($va08f2aee9de301619776deb6fee83e50, $v525fb5c69c6f5250b26f0c4fa60f7d61);$va0c391dc49c440fc9962168353cedde3 = $vdb6d9b451b818ccc9a449383f2f0c450->getType($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);$va0c391dc49c440fc9962168353cedde3->setIsGuidable(true);$va0c391dc49c440fc9962168353cedde3->setIsPublic(true);$va0c391dc49c440fc9962168353cedde3->commit();return $v52eb29c6d8ea0d3a5bb3654f49bbd7c7;}public function enableEvents() {$this->eventsEnabled = true;return $this;}public function disableEvents() {$this->eventsEnabled = false;return $this;}protected function importField(iUmiFieldsGroup $vdb0f6f37ebeb6ea09489124345af2a45, DOMElement $v89a2007e7c15e80c35f21ea4a4540700) {$vb5cf8e26a05f5b35fcd36ef010257265 = $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('name');if (!$vb5cf8e26a05f5b35fcd36ef010257265) {$this->reportError($this->getLabel('label-cannot-import-field-with-empty-name'));return false;}$vd5d3db1765287eef77d7927cc956f50a = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('title') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('title') : null;$v6a2139364f96787c8ce1bbb0070b898c = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('tip') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('tip') : null;$v19fad0416b4b101ab72faccf4c323024 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('visible') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('visible') : null;$v73b8754d45983f35756b157ea439de8c = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('locked') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('locked') : null;$v55e0eccc570671ca7ba7f5ef4ded0b96 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('inheritable') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('inheritable') : null;$v2c6c4f8bafad4553c424b6f984980894 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('indexable') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('indexable') : null;$va93254f262fa924c92240830911e3ec5 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('filterable') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('filterable') : null;$v2a9d32d17ad47ac15c87d2e7c96d0e69 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('required') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('required') : null;$v03c1f379372e00d33098fed2f34f423a = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('system') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('system') : null;$v8643f8934c2da1367e8f2b996df3d117 = $v89a2007e7c15e80c35f21ea4a4540700->hasAttribute('important') ? $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('important') : null;$v24945aa5fabc80446599d7760348d114 = self::translateName($vb5cf8e26a05f5b35fcd36ef010257265);$v6301cee35ea764a1e241978f93f01069 = $vdb0f6f37ebeb6ea09489124345af2a45->getTypeId();$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldsCollection::getInstance();$vb3827f7111095f5ba1a9f49988fe9382 = umiObjectTypesCollection::getInstance();$v06e3d36fa30cea095545139854ad1fb9 = null;$vb7408d62f2d1b964d53d4325c01b9d87 = $this->parser->evaluate('type', $v89a2007e7c15e80c35f21ea4a4540700);$v2c5b45db1c21822c5051751bcf5c1dfe = $vb7408d62f2d1b964d53d4325c01b9d87->length ? $vb7408d62f2d1b964d53d4325c01b9d87->item(0) : false;if (!$v2c5b45db1c21822c5051751bcf5c1dfe) {$this->reportError($this->getLabel('label-cannot-import-field') . " {$vb5cf8e26a05f5b35fcd36ef010257265}: " . $this->getLabel('label-cannot-detect-datatype'));return false;}$v833750ac635fcc57dc33ecafe365f9a7 = $this->importFieldType($v2c5b45db1c21822c5051751bcf5c1dfe);if (!$v833750ac635fcc57dc33ecafe365f9a7 instanceof iUmiFieldType) {$this->reportError($this->getLabel('label-cannot-detect-field-type-for') . " {$vb5cf8e26a05f5b35fcd36ef010257265}");return false;}$ve2aeb4e882d60b1eb4b7c8cd97986a28 = $v833750ac635fcc57dc33ecafe365f9a7->getId();$v726e8e4809d4c1b28a6549d86436a124 = $vb3827f7111095f5ba1a9f49988fe9382->getType($v6301cee35ea764a1e241978f93f01069);$v945100186b119048837b9859c2c46410 = $v726e8e4809d4c1b28a6549d86436a124->getFieldId($v24945aa5fabc80446599d7760348d114, false);if ($v945100186b119048837b9859c2c46410) {$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v945100186b119048837b9859c2c46410);if ($v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField && $v945100186b119048837b9859c2c46410 != $this->relations->getNewFieldId($this->source_id, $v6301cee35ea764a1e241978f93f01069, $vb5cf8e26a05f5b35fcd36ef010257265)) {$this->relations->setFieldIdRelation($this->source_id, $v6301cee35ea764a1e241978f93f01069, $vb5cf8e26a05f5b35fcd36ef010257265, $v945100186b119048837b9859c2c46410);}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {$va08f2aee9de301619776deb6fee83e50 = $v726e8e4809d4c1b28a6549d86436a124->getParentId();if ($va08f2aee9de301619776deb6fee83e50) {$v2d167696e35bbbaa2b026d0ffbbeaf68 = $vb3827f7111095f5ba1a9f49988fe9382->getType($va08f2aee9de301619776deb6fee83e50);$v73e982ea8fa7989b4060e410400c75ea = $v2d167696e35bbbaa2b026d0ffbbeaf68->getFieldId($v24945aa5fabc80446599d7760348d114, false);if ($v73e982ea8fa7989b4060e410400c75ea) {$v239407987de466be3f94ce70d7139134 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v73e982ea8fa7989b4060e410400c75ea);if ($v239407987de466be3f94ce70d7139134->getFieldTypeId() == $ve2aeb4e882d60b1eb4b7c8cd97986a28 && $v239407987de466be3f94ce70d7139134->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $v239407987de466be3f94ce70d7139134;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v73e982ea8fa7989b4060e410400c75ea);$this->relations->setFieldIdRelation($this->source_id, $v6301cee35ea764a1e241978f93f01069, $vb5cf8e26a05f5b35fcd36ef010257265, $v06e3d36fa30cea095545139854ad1fb9->getId());}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {$v03be65d3c45a7607e9fa8b7bba65ef70 = $vb3827f7111095f5ba1a9f49988fe9382->getSubTypesList($va08f2aee9de301619776deb6fee83e50);foreach ($v03be65d3c45a7607e9fa8b7bba65ef70 as $vca9d481e9025ceb3bb0c3f8f3ecfe0d6) {if ($vca9d481e9025ceb3bb0c3f8f3ecfe0d6 == $v6301cee35ea764a1e241978f93f01069) {continue;}$v7d241d5cf330e80cf9619b5e0f79ff55 = $vb3827f7111095f5ba1a9f49988fe9382->getType($vca9d481e9025ceb3bb0c3f8f3ecfe0d6);if (!$v7d241d5cf330e80cf9619b5e0f79ff55 instanceof iUmiObjectType) {continue;}$v77dd616ec13616a1bec32aebbdf9d315 = $v7d241d5cf330e80cf9619b5e0f79ff55->getFieldId($v24945aa5fabc80446599d7760348d114, false);if ($v77dd616ec13616a1bec32aebbdf9d315) {$vea073dea8b46970b068f96b15ad98cac = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v77dd616ec13616a1bec32aebbdf9d315);if (!$vea073dea8b46970b068f96b15ad98cac instanceof iUmiField) {continue;}if ($vea073dea8b46970b068f96b15ad98cac->getFieldTypeId() == $ve2aeb4e882d60b1eb4b7c8cd97986a28 && $vea073dea8b46970b068f96b15ad98cac->getTitle() == $vd5d3db1765287eef77d7927cc956f50a) {$v06e3d36fa30cea095545139854ad1fb9 = $vea073dea8b46970b068f96b15ad98cac;$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v77dd616ec13616a1bec32aebbdf9d315);$this->relations->setFieldIdRelation($this->source_id, $v6301cee35ea764a1e241978f93f01069, $vb5cf8e26a05f5b35fcd36ef010257265, $v06e3d36fa30cea095545139854ad1fb9->getId());break;}}}}}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {if ($vd5d3db1765287eef77d7927cc956f50a === null) {$vd5d3db1765287eef77d7927cc956f50a = $vb5cf8e26a05f5b35fcd36ef010257265;}$v945100186b119048837b9859c2c46410 = $vdb6d9b451b818ccc9a449383f2f0c450->addField($v24945aa5fabc80446599d7760348d114, trim($vd5d3db1765287eef77d7927cc956f50a), $ve2aeb4e882d60b1eb4b7c8cd97986a28, false);$this->relations->setFieldIdRelation($this->source_id, $v6301cee35ea764a1e241978f93f01069, $vb5cf8e26a05f5b35fcd36ef010257265, $v945100186b119048837b9859c2c46410);$vdb0f6f37ebeb6ea09489124345af2a45->attachField($v945100186b119048837b9859c2c46410);$v06e3d36fa30cea095545139854ad1fb9 = $vdb6d9b451b818ccc9a449383f2f0c450->getField($v945100186b119048837b9859c2c46410);if ($v19fad0416b4b101ab72faccf4c323024 === null) {$v06e3d36fa30cea095545139854ad1fb9->setIsVisible($v19fad0416b4b101ab72faccf4c323024);}if ($va93254f262fa924c92240830911e3ec5 === null) {$v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va93254f262fa924c92240830911e3ec5);}if ($v2c6c4f8bafad4553c424b6f984980894 === null) {$v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($v2c6c4f8bafad4553c424b6f984980894);}}if (($v833750ac635fcc57dc33ecafe365f9a7->getDataType() == 'relation' || $v833750ac635fcc57dc33ecafe365f9a7->getDataType() == 'optioned') && $this->auto_guide_creation) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($this->getAutoGuideId($vd5d3db1765287eef77d7927cc956f50a));}if ($v06e3d36fa30cea095545139854ad1fb9->getFieldTypeId() != $ve2aeb4e882d60b1eb4b7c8cd97986a28) {$v06e3d36fa30cea095545139854ad1fb9->setFieldTypeId($ve2aeb4e882d60b1eb4b7c8cd97986a28);}if ($vd5d3db1765287eef77d7927cc956f50a !== null) {$v06e3d36fa30cea095545139854ad1fb9->setTitle(trim($vd5d3db1765287eef77d7927cc956f50a));}if ($v19fad0416b4b101ab72faccf4c323024 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsVisible($v19fad0416b4b101ab72faccf4c323024 == 'visible' || $v19fad0416b4b101ab72faccf4c323024 == '1');}if ($v2c6c4f8bafad4553c424b6f984980894 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsInSearch($v2c6c4f8bafad4553c424b6f984980894 == 'indexable' || $v2c6c4f8bafad4553c424b6f984980894 == '1');}if ($va93254f262fa924c92240830911e3ec5 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsInFilter($va93254f262fa924c92240830911e3ec5 == 'filterable' || $va93254f262fa924c92240830911e3ec5 == '1');}if ($v2a9d32d17ad47ac15c87d2e7c96d0e69 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsRequired($v2a9d32d17ad47ac15c87d2e7c96d0e69 == 'required' || $v2a9d32d17ad47ac15c87d2e7c96d0e69 == '1');}if ($v03c1f379372e00d33098fed2f34f423a !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsSystem($v03c1f379372e00d33098fed2f34f423a == 'system' || $v03c1f379372e00d33098fed2f34f423a == '1');}if ($v6a2139364f96787c8ce1bbb0070b898c !== null) {$v06e3d36fa30cea095545139854ad1fb9->setTip(trim($v6a2139364f96787c8ce1bbb0070b898c));}if ($v73b8754d45983f35756b157ea439de8c !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsLocked($v73b8754d45983f35756b157ea439de8c == 'locked' || $v73b8754d45983f35756b157ea439de8c == '1');}if ($v55e0eccc570671ca7ba7f5ef4ded0b96 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setIsInheritable($v55e0eccc570671ca7ba7f5ef4ded0b96 == 'inheritable' || $v55e0eccc570671ca7ba7f5ef4ded0b96 == '1');}if ($v8643f8934c2da1367e8f2b996df3d117 !== null) {$v06e3d36fa30cea095545139854ad1fb9->setImportanceStatus((bool) $v8643f8934c2da1367e8f2b996df3d117);}$ve4c9479b11955648dad558fe717a4eb2 = $this->parser->evaluate('tip', $v89a2007e7c15e80c35f21ea4a4540700);$v6a2139364f96787c8ce1bbb0070b898c = $ve4c9479b11955648dad558fe717a4eb2->length ? $ve4c9479b11955648dad558fe717a4eb2->item(0) : false;if ($v6a2139364f96787c8ce1bbb0070b898c) {$v06e3d36fa30cea095545139854ad1fb9->setTip($v6a2139364f96787c8ce1bbb0070b898c->nodeValue);}$v06e3d36fa30cea095545139854ad1fb9->commit();return $v06e3d36fa30cea095545139854ad1fb9;}protected function importElements() {$vb3b32a2d422265cd25c3323ed0157f81 = $this->parser->evaluate('/umidump/pages/page');foreach ($vb3b32a2d422265cd25c3323ed0157f81 as $v77f3c48f175369c446fbe421012437c2) {$this->importElement($v77f3c48f175369c446fbe421012437c2);}}protected function detectTemplateId($v6a2a431fe8b621037ea949531c28551d, $v72ee76c5c29383b7c9f9225c1fa4d10b = false, $vf585b7f018bb4ced15a03683a733e50b = false) {if (!$v6a2a431fe8b621037ea949531c28551d) {return false;}$v72ee76c5c29383b7c9f9225c1fa4d10b = $v72ee76c5c29383b7c9f9225c1fa4d10b ?: Service::DomainDetector()->detectId();$vf585b7f018bb4ced15a03683a733e50b = $vf585b7f018bb4ced15a03683a733e50b ?: Service::LanguageDetector()->detectId();$v4334e531f3928afebdbe8f44febfc0fa = templatesCollection::getInstance()    ->getTemplatesList($v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b);foreach ($v4334e531f3928afebdbe8f44febfc0fa as $v66f6181bcb4cff4cd38fbc804a036db6) {if ($v66f6181bcb4cff4cd38fbc804a036db6->getFilename() == $v6a2a431fe8b621037ea949531c28551d || (is_numeric($v6a2a431fe8b621037ea949531c28551d) && $v6a2a431fe8b621037ea949531c28551d == $v66f6181bcb4cff4cd38fbc804a036db6->getId())) {return $v66f6181bcb4cff4cd38fbc804a036db6->getId();}}return false;}protected function importHierarchy() {$v2152507e770d48f2aa8ff039be4573f9 = $this->parser->evaluate('/umidump/hierarchy/relation');$v3a6dbc22c79208bc65665635bc19d967 = [];foreach ($v2152507e770d48f2aa8ff039be4573f9 as $vf03ad9e4ebc731946c49a47a1a26925d) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->importHierarchyRelation($vf03ad9e4ebc731946c49a47a1a26925d);if ($vbfa030fe63bacd523dd70a76cfaed98a !== false) {$v3a6dbc22c79208bc65665635bc19d967[] = $vbfa030fe63bacd523dd70a76cfaed98a;}}$v475d6424dac268bb5fffd0235530c333 = umiHierarchy::getInstance();foreach ($v3a6dbc22c79208bc65665635bc19d967 as $vbfa030fe63bacd523dd70a76cfaed98a) {$v475d6424dac268bb5fffd0235530c333->rebuildRelationNodes($vbfa030fe63bacd523dd70a76cfaed98a);}}protected function importHierarchyRelation(DOMElement $vf03ad9e4ebc731946c49a47a1a26925d) {$v3bd920688a19a611654416dbea871efa = $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('id');$vc02811e4c4fdd0b3549131ca8a2c74d1 = $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('parent-id');$v8bef1cc20ada3bef55fdf132cb2a1cb9 = $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('ord');$vf217d192b83450a454e357c127b20ff2 = false;$v7552cd149af7495ee7d8225974e50f80 = $this->relations->getNewIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if (!$v7552cd149af7495ee7d8225974e50f80) {return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = umiHierarchy::getInstance();$v8e2dcfd7e7e24b1ca76c1193f645902b = $vdb6d9b451b818ccc9a449383f2f0c450->getElement($v7552cd149af7495ee7d8225974e50f80, true, true);if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {return false;}$vbfa030fe63bacd523dd70a76cfaed98a = false;if ($vc02811e4c4fdd0b3549131ca8a2c74d1) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->relations->getNewIdRelation($this->source_id, $vc02811e4c4fdd0b3549131ca8a2c74d1);}if ($vbfa030fe63bacd523dd70a76cfaed98a === false) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->destination_element_id;}try {if ($vbfa030fe63bacd523dd70a76cfaed98a != $v8e2dcfd7e7e24b1ca76c1193f645902b->getParentId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setRel($vbfa030fe63bacd523dd70a76cfaed98a);$vf217d192b83450a454e357c127b20ff2 = true;}}catch (coreException $ve1671797c52e15f763380b45e841ec32) {return false;}if ($v8bef1cc20ada3bef55fdf132cb2a1cb9 && $v8bef1cc20ada3bef55fdf132cb2a1cb9 != $v8e2dcfd7e7e24b1ca76c1193f645902b->getOrd()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setOrd($v8bef1cc20ada3bef55fdf132cb2a1cb9);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();}if ($vf217d192b83450a454e357c127b20ff2) {$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();return $vbfa030fe63bacd523dd70a76cfaed98a;}return false;}protected function importElement(DOMElement $v77f3c48f175369c446fbe421012437c2, $v7d3679e2429816eae9694dd8f60cc97d = true) {$v3bd920688a19a611654416dbea871efa = $v77f3c48f175369c446fbe421012437c2->getAttribute('id');$v506213e108aa2d8a53dce233d3ead162 = $v77f3c48f175369c446fbe421012437c2->getAttribute('type-id');$v6e313761a5b0e74c268b15a1ba391784 = $v77f3c48f175369c446fbe421012437c2->getAttribute('update-only') == '1';$v4127273220e2246564241a28de2cec12 = $v77f3c48f175369c446fbe421012437c2->getElementsByTagName('name');$vb068931cc450442b63f5b3d276ea4297 = $v4127273220e2246564241a28de2cec12->length ? $v4127273220e2246564241a28de2cec12->item(0)->nodeValue : false;$va2234dc2f8e1676de51f355192b1300e = $v77f3c48f175369c446fbe421012437c2->getElementsByTagName('template');$v66f6181bcb4cff4cd38fbc804a036db6 = $va2234dc2f8e1676de51f355192b1300e->length ? $va2234dc2f8e1676de51f355192b1300e->item(0)->nodeValue : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError("Can't create element \"{$vb068931cc450442b63f5b3d276ea4297}\" with empty id");return false;}$v0330da281541887f65b0a60066351c91 = $v77f3c48f175369c446fbe421012437c2->getAttribute('alt-name');if (!$v0330da281541887f65b0a60066351c91) {$v0330da281541887f65b0a60066351c91 = $vb068931cc450442b63f5b3d276ea4297;}$v367e854225a0810977297b3bedb2f309 = $v77f3c48f175369c446fbe421012437c2->hasAttribute('is-active') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('is-active') : null;$vc02811e4c4fdd0b3549131ca8a2c74d1 = $v77f3c48f175369c446fbe421012437c2->hasAttribute('parentId') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('parentId') : null;$v19fad0416b4b101ab72faccf4c323024 = $v77f3c48f175369c446fbe421012437c2->hasAttribute('is-visible') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('is-visible') : null;$va18b1057c4327b9cc46abc9fcf952bd8 = $v77f3c48f175369c446fbe421012437c2->hasAttribute('is-deleted') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('is-deleted') : null;$vf585b7f018bb4ced15a03683a733e50b = $v77f3c48f175369c446fbe421012437c2->hasAttribute('lang-id') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('lang-id') : false;$v72ee76c5c29383b7c9f9225c1fa4d10b = $v77f3c48f175369c446fbe421012437c2->hasAttribute('domain-id') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('domain-id') : false;$ve558e63f3083922542d8745224a66eea = $v77f3c48f175369c446fbe421012437c2->hasAttribute('is-default') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('is-default') : false;if ($v72ee76c5c29383b7c9f9225c1fa4d10b) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $this->relations->getNewDomainIdRelation($this->source_id, $v72ee76c5c29383b7c9f9225c1fa4d10b);}if ($vf585b7f018bb4ced15a03683a733e50b) {$vf585b7f018bb4ced15a03683a733e50b = $this->relations->getNewLangIdRelation($this->source_id, $vf585b7f018bb4ced15a03683a733e50b);}$v475d6424dac268bb5fffd0235530c333 = umiHierarchy::getInstance();$v8988aed53b6f4f4932b092de09f31980 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v7552cd149af7495ee7d8225974e50f80 = $this->relations->getNewIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if ($v7552cd149af7495ee7d8225974e50f80 && $this->update_ignore) {$this->writeLog('Element "' . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v3bd920688a19a611654416dbea871efa}) already exists");return $v475d6424dac268bb5fffd0235530c333->getElement($v7552cd149af7495ee7d8225974e50f80);}if (!$v7552cd149af7495ee7d8225974e50f80) {if ($v6e313761a5b0e74c268b15a1ba391784) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = $v3bd920688a19a611654416dbea871efa;}if (!$v506213e108aa2d8a53dce233d3ead162) {$this->reportError($this->getLabel('label-cannot-create-element') . ": \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v3bd920688a19a611654416dbea871efa}) ." . $this->getLabel('label-cannot-detect-type'));return false;}$v5f694956811487225d15e973ca38fbab = $this->relations->getNewTypeIdRelation($this->source_id, $v506213e108aa2d8a53dce233d3ead162);$v599dcce2998a6b40b1e38e8c6006cb0a = $v8988aed53b6f4f4932b092de09f31980->getType($v5f694956811487225d15e973ca38fbab);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiObjectType) {$this->reportError($this->getLabel('label-cannot-create-element') . "\"{$vb068931cc450442b63f5b3d276ea4297}\" ($v3bd920688a19a611654416dbea871efa): " . $this->getLabel('label-cannot-detect-type') . " #{$v506213e108aa2d8a53dce233d3ead162}");return false;}$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!Service::Registry()->get("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) {$this->reportError(        $this->getLabel('label-cannot-create-element') . "\"{$vb068931cc450442b63f5b3d276ea4297}\" ($v3bd920688a19a611654416dbea871efa): " .        $this->getLabel('label-module-not-installed', false, $v22884db148f0ffb0d830ba431102b0b5)       );return false;}}}$vbfa030fe63bacd523dd70a76cfaed98a = false;if ($vc02811e4c4fdd0b3549131ca8a2c74d1) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->relations->getNewIdRelation($this->source_id, $vc02811e4c4fdd0b3549131ca8a2c74d1);}if ($vbfa030fe63bacd523dd70a76cfaed98a === false) {$vbfa030fe63bacd523dd70a76cfaed98a = $this->destination_element_id;}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnAddElement');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('before');$v4119639092e62c55ea8be348e4d9260d->setParam('parent_id', $vbfa030fe63bacd523dd70a76cfaed98a);$v4119639092e62c55ea8be348e4d9260d->setParam('old_element_id', $v3bd920688a19a611654416dbea871efa);$v4119639092e62c55ea8be348e4d9260d->setParam('type', $v599dcce2998a6b40b1e38e8c6006cb0a);$v4119639092e62c55ea8be348e4d9260d->setParam('element_info', $v77f3c48f175369c446fbe421012437c2);$v4119639092e62c55ea8be348e4d9260d->addRef('parent_id', $vbfa030fe63bacd523dd70a76cfaed98a);$v4119639092e62c55ea8be348e4d9260d->addRef('old_element_id', $v3bd920688a19a611654416dbea871efa);$v4119639092e62c55ea8be348e4d9260d->addRef('type', $v599dcce2998a6b40b1e38e8c6006cb0a);$v4119639092e62c55ea8be348e4d9260d->addRef('name', $vb068931cc450442b63f5b3d276ea4297);$v4119639092e62c55ea8be348e4d9260d->addRef('alt_name', $v0330da281541887f65b0a60066351c91);$v4119639092e62c55ea8be348e4d9260d->addRef('parent_id', $vbfa030fe63bacd523dd70a76cfaed98a);$v4119639092e62c55ea8be348e4d9260d->addRef('domain_id', $v72ee76c5c29383b7c9f9225c1fa4d10b);$v4119639092e62c55ea8be348e4d9260d->addRef('lang_id', $vf585b7f018bb4ced15a03683a733e50b);$v4119639092e62c55ea8be348e4d9260d->addRef('element_info', $v77f3c48f175369c446fbe421012437c2);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);$v7552cd149af7495ee7d8225974e50f80 = $v475d6424dac268bb5fffd0235530c333->addElement($vbfa030fe63bacd523dd70a76cfaed98a, $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId(), $vb068931cc450442b63f5b3d276ea4297, $v0330da281541887f65b0a60066351c91, $v599dcce2998a6b40b1e38e8c6006cb0a->getId(), $v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b);$this->imported_elements[] = $v7552cd149af7495ee7d8225974e50f80;permissionsCollection::getInstance()->setDefaultPermissions($v7552cd149af7495ee7d8225974e50f80);$this->relations->setIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v7552cd149af7495ee7d8225974e50f80);if ($v367e854225a0810977297b3bedb2f309 === null) {$v4127273220e2246564241a28de2cec12 = $v77f3c48f175369c446fbe421012437c2->getElementsByTagName('default-active');if ($v4127273220e2246564241a28de2cec12->length) {$v367e854225a0810977297b3bedb2f309 = $v4127273220e2246564241a28de2cec12->item(0)->nodeValue;}}if ($v19fad0416b4b101ab72faccf4c323024 === null) {$v4127273220e2246564241a28de2cec12 = $v77f3c48f175369c446fbe421012437c2->getElementsByTagName('default-visible');if ($v4127273220e2246564241a28de2cec12->length) {$v19fad0416b4b101ab72faccf4c323024 = $v4127273220e2246564241a28de2cec12->item(0)->nodeValue;}}if ($v66f6181bcb4cff4cd38fbc804a036db6 === null) {$v4127273220e2246564241a28de2cec12 = $v77f3c48f175369c446fbe421012437c2->getElementsByTagName('default-template');if ($v4127273220e2246564241a28de2cec12->length) {$v66f6181bcb4cff4cd38fbc804a036db6 = $v4127273220e2246564241a28de2cec12->item(0)->nodeValue;}}$ve2fa538867c3830a859a5b17ab24644b = true;}$v8e2dcfd7e7e24b1ca76c1193f645902b = $v475d6424dac268bb5fffd0235530c333->getElement($v7552cd149af7495ee7d8225974e50f80, true, true);$v86dce043678952b27d5b27a5296f020c = $v77f3c48f175369c446fbe421012437c2->hasAttribute('install-only') ? (bool) $v77f3c48f175369c446fbe421012437c2->getAttribute('install-only') : false;if (!$v8e2dcfd7e7e24b1ca76c1193f645902b instanceof iUmiHierarchyElement) {return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if (!$ve2fa538867c3830a859a5b17ab24644b) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnUpdateElement');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('before');$v4119639092e62c55ea8be348e4d9260d->addRef('element', $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setParam('element_info', $v77f3c48f175369c446fbe421012437c2);$v4119639092e62c55ea8be348e4d9260d->addRef('name', $vb068931cc450442b63f5b3d276ea4297);$v4119639092e62c55ea8be348e4d9260d->addRef('is_active', $v367e854225a0810977297b3bedb2f309);$v4119639092e62c55ea8be348e4d9260d->addRef('is_visible', $v19fad0416b4b101ab72faccf4c323024);$v4119639092e62c55ea8be348e4d9260d->addRef('is_default', $ve558e63f3083922542d8745224a66eea);$v4119639092e62c55ea8be348e4d9260d->addRef('template_path', $v66f6181bcb4cff4cd38fbc804a036db6);$v4119639092e62c55ea8be348e4d9260d->addRef('is_deleted', $va18b1057c4327b9cc46abc9fcf952bd8);$v4119639092e62c55ea8be348e4d9260d->addRef('element_info', $v77f3c48f175369c446fbe421012437c2);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}if ($vb068931cc450442b63f5b3d276ea4297) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setName($vb068931cc450442b63f5b3d276ea4297);}if ($v367e854225a0810977297b3bedb2f309 !== null) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsActive($v367e854225a0810977297b3bedb2f309 == 'active' || $v367e854225a0810977297b3bedb2f309 == '1');}if ($v19fad0416b4b101ab72faccf4c323024 !== null) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsVisible($v19fad0416b4b101ab72faccf4c323024 == 'visible' || $v19fad0416b4b101ab72faccf4c323024 == '1');}if ($ve558e63f3083922542d8745224a66eea) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setIsDefault($ve558e63f3083922542d8745224a66eea == 'default' || $ve558e63f3083922542d8745224a66eea == '1');}if ($v66f6181bcb4cff4cd38fbc804a036db6 !== null && $vd02e12eb6d6c3f6ebd763197df01e211 = $this->detectTemplateId($v66f6181bcb4cff4cd38fbc804a036db6, $v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b)) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setTplId($vd02e12eb6d6c3f6ebd763197df01e211);}if ($ve2fa538867c3830a859a5b17ab24644b) {$v64e17a1299a4e6867ddf991da07d8275 = $v77f3c48f175369c446fbe421012437c2->hasAttribute('object-id') ? $v77f3c48f175369c446fbe421012437c2->getAttribute('object-id') : null;if ($v64e17a1299a4e6867ddf991da07d8275 !== null) {$v16b2b26000987faccb260b9d39df1269 = $v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectId();$v399c32699000f9c132ed4c9c9dbba2a3 = $this->relations->getNewObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275);if ($v399c32699000f9c132ed4c9c9dbba2a3) {$va8cfde6331bd59eb2ac96f8911c4b666 = umiObjectsCollection::getInstance()->getObject($v399c32699000f9c132ed4c9c9dbba2a3);if ($v8e2dcfd7e7e24b1ca76c1193f645902b->getObjectTypeId() == $va8cfde6331bd59eb2ac96f8911c4b666->getTypeId()) {$v8e2dcfd7e7e24b1ca76c1193f645902b->setObject($va8cfde6331bd59eb2ac96f8911c4b666);$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();umiObjectsCollection::getInstance()->delObject($v16b2b26000987faccb260b9d39df1269);}else {$this->relations->setObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275, $v16b2b26000987faccb260b9d39df1269);}}else {$this->relations->setObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275, $v16b2b26000987faccb260b9d39df1269);}}}if ($va18b1057c4327b9cc46abc9fcf952bd8 == 'deleted' || $va18b1057c4327b9cc46abc9fcf952bd8 == '1') {$v8e2dcfd7e7e24b1ca76c1193f645902b->setDeleted();}if ($v7d3679e2429816eae9694dd8f60cc97d) {$this->importPropValues($v8e2dcfd7e7e24b1ca76c1193f645902b, $v77f3c48f175369c446fbe421012437c2, $ve2fa538867c3830a859a5b17ab24644b);}if ($va18b1057c4327b9cc46abc9fcf952bd8 && ($va18b1057c4327b9cc46abc9fcf952bd8 == 'deleted' || $va18b1057c4327b9cc46abc9fcf952bd8 == '1')) {$this->deleted_elements++;$this->writeLog($this->getLabel('label-page') . ' "' . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-deleted-m'));}elseif ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_elements++;$this->writeLog($this->getLabel('label-page') . ' "' . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-f'));}elseif ($v8e2dcfd7e7e24b1ca76c1193f645902b->getIsUpdated()) {$this->updated_elements++;$this->writeLog($this->getLabel('label-page') . ' "' . $v8e2dcfd7e7e24b1ca76c1193f645902b->getName() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-f'));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnAddElement');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->addRef('element', $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setParam('element_info', $v77f3c48f175369c446fbe421012437c2);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}else {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnUpdateElement');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->addRef('element', $v8e2dcfd7e7e24b1ca76c1193f645902b);$v4119639092e62c55ea8be348e4d9260d->setParam('element_info', $v77f3c48f175369c446fbe421012437c2);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}$v8e2dcfd7e7e24b1ca76c1193f645902b->commit();$v475d6424dac268bb5fffd0235530c333->unloadElement($v7552cd149af7495ee7d8225974e50f80);return $v8e2dcfd7e7e24b1ca76c1193f645902b;}protected function importLangs() {$vf3e334d42863e8250c7d03efefbfd387 = $this->parser->evaluate('/umidump/langs/lang');foreach ($vf3e334d42863e8250c7d03efefbfd387 as $vc0229aeaa9ca9d19d534195c827542b9) {$this->importLang($vc0229aeaa9ca9d19d534195c827542b9);}}protected function importLang(DOMElement $va24bcccab40205d7e681050e137f6c99) {$v3bd920688a19a611654416dbea871efa = $va24bcccab40205d7e681050e137f6c99->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $va24bcccab40205d7e681050e137f6c99->nodeValue;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$ve558e63f3083922542d8745224a66eea = $va24bcccab40205d7e681050e137f6c99->hasAttribute('is-default') ? $va24bcccab40205d7e681050e137f6c99->getAttribute('is-default') : null;$v851f5ac9941d720844d143ed9cfcf60a = $va24bcccab40205d7e681050e137f6c99->hasAttribute('prefix') ? $va24bcccab40205d7e681050e137f6c99->getAttribute('prefix') : null;$vdb6d9b451b818ccc9a449383f2f0c450 = Service::LanguageCollection();$ve2fa538867c3830a859a5b17ab24644b = false;$v694b5b6b5536d28285396c8ce7c268bc = $this->relations->getNewLangIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if (!$v694b5b6b5536d28285396c8ce7c268bc && $v851f5ac9941d720844d143ed9cfcf60a) {$v694b5b6b5536d28285396c8ce7c268bc = $vdb6d9b451b818ccc9a449383f2f0c450->getLangId($v851f5ac9941d720844d143ed9cfcf60a);if ($v694b5b6b5536d28285396c8ce7c268bc) {$this->relations->setLangIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v694b5b6b5536d28285396c8ce7c268bc);}}if (!$v694b5b6b5536d28285396c8ce7c268bc) {if (!$vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $v3bd920688a19a611654416dbea871efa;}$v694b5b6b5536d28285396c8ce7c268bc = $vdb6d9b451b818ccc9a449383f2f0c450->addLang($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a);$this->relations->setLangIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v694b5b6b5536d28285396c8ce7c268bc);$ve2fa538867c3830a859a5b17ab24644b = true;}$v8512ae7d57b1396273f76fe6ed341a23 = $vdb6d9b451b818ccc9a449383f2f0c450->getLang($v694b5b6b5536d28285396c8ce7c268bc);$v86dce043678952b27d5b27a5296f020c = $va24bcccab40205d7e681050e137f6c99->hasAttribute('install-only') ? (bool) $va24bcccab40205d7e681050e137f6c99->getAttribute('install-only') : false;if (!$v8512ae7d57b1396273f76fe6ed341a23 instanceof iLang) {$this->reportError($this->getLabel('label-cannot-detect-language') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" ");return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if ($vd5d3db1765287eef77d7927cc956f50a) {$v8512ae7d57b1396273f76fe6ed341a23->setTitle($vd5d3db1765287eef77d7927cc956f50a);}if ($ve558e63f3083922542d8745224a66eea !== null && $ve558e63f3083922542d8745224a66eea) {$vdb6d9b451b818ccc9a449383f2f0c450->setDefault($v694b5b6b5536d28285396c8ce7c268bc);}if ($v851f5ac9941d720844d143ed9cfcf60a !== null) {$v8512ae7d57b1396273f76fe6ed341a23->setPrefix($v851f5ac9941d720844d143ed9cfcf60a);}$v8512ae7d57b1396273f76fe6ed341a23->commit();if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_languages++;$this->writeLog($this->getLabel('label-language') . ' "' . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-m'));}elseif ($v8512ae7d57b1396273f76fe6ed341a23->getIsUpdated()) {$this->updated_languages++;$this->writeLog($this->getLabel('label-language') . ' "' . $v8512ae7d57b1396273f76fe6ed341a23->getTitle() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-m'));}return $v8512ae7d57b1396273f76fe6ed341a23;}protected function importDomains() {$ve4e46deb7f9cc58c7abfb32e5570b6f3 = $this->parser->evaluate('/umidump/domains/domain');foreach ($ve4e46deb7f9cc58c7abfb32e5570b6f3 as $v204aadf644884156d194b4fccb7a101a) {$this->importDomain($v204aadf644884156d194b4fccb7a101a);}}protected function importDomain(DOMElement $v204aadf644884156d194b4fccb7a101a) {$v3bd920688a19a611654416dbea871efa = $v204aadf644884156d194b4fccb7a101a->getAttribute('id');$v67b3dba8bc6778101892eb77249db32e = $v204aadf644884156d194b4fccb7a101a->hasAttribute('host') ? $v204aadf644884156d194b4fccb7a101a->getAttribute('host') : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$vfff2750d7f6fe6e8adb4bd98e87b03f5 = $v204aadf644884156d194b4fccb7a101a->hasAttribute('lang-id') ? $v204aadf644884156d194b4fccb7a101a->getAttribute('lang-id') : null;$ve558e63f3083922542d8745224a66eea = $v204aadf644884156d194b4fccb7a101a->hasAttribute('is-default') ? $v204aadf644884156d194b4fccb7a101a->getAttribute('is-default') : null;$v66e6283a2d6b70fd594bdf4f315d6074 = $v204aadf644884156d194b4fccb7a101a->hasAttribute('using-ssl') ? $v204aadf644884156d194b4fccb7a101a->getAttribute('using-ssl') : null;$v068ee263b9951356e828019683f53948 = Service::DomainCollection();$ve2fa538867c3830a859a5b17ab24644b = false;$v72ee76c5c29383b7c9f9225c1fa4d10b = $this->relations->getNewDomainIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if (!$v72ee76c5c29383b7c9f9225c1fa4d10b && $v67b3dba8bc6778101892eb77249db32e) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $v068ee263b9951356e828019683f53948->getDomainId($v67b3dba8bc6778101892eb77249db32e);if ($v72ee76c5c29383b7c9f9225c1fa4d10b) {$this->relations->setDomainIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v72ee76c5c29383b7c9f9225c1fa4d10b);}}if ($v72ee76c5c29383b7c9f9225c1fa4d10b && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . ' "' . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v3bd920688a19a611654416dbea871efa}) " . $this->getLabel('label-already-exists'));return $v068ee263b9951356e828019683f53948->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);}if (!$v72ee76c5c29383b7c9f9225c1fa4d10b) {if (!$v67b3dba8bc6778101892eb77249db32e) {$v67b3dba8bc6778101892eb77249db32e = $v3bd920688a19a611654416dbea871efa;}$vf585b7f018bb4ced15a03683a733e50b = false;if ($vfff2750d7f6fe6e8adb4bd98e87b03f5 !== null) {$vf585b7f018bb4ced15a03683a733e50b = $this->relations->getNewLangIdRelation($this->source_id, $vfff2750d7f6fe6e8adb4bd98e87b03f5);}if (!$vf585b7f018bb4ced15a03683a733e50b) {$vf585b7f018bb4ced15a03683a733e50b = Service::LanguageCollection()->getDefaultLang()->getId();}$v72ee76c5c29383b7c9f9225c1fa4d10b = $v068ee263b9951356e828019683f53948->addDomain($v67b3dba8bc6778101892eb77249db32e, $vf585b7f018bb4ced15a03683a733e50b, $ve558e63f3083922542d8745224a66eea, $v66e6283a2d6b70fd594bdf4f315d6074);$this->relations->setDomainIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v72ee76c5c29383b7c9f9225c1fa4d10b);$ve2fa538867c3830a859a5b17ab24644b = true;}$vad5f82e879a9c5d6b5b442eb37e50551 = $v068ee263b9951356e828019683f53948->getDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);$v86dce043678952b27d5b27a5296f020c = $v204aadf644884156d194b4fccb7a101a->hasAttribute('install-only') ? (bool) $v204aadf644884156d194b4fccb7a101a->getAttribute('install-only') : false;if (!$vad5f82e879a9c5d6b5b442eb37e50551 instanceof iDomain) {$this->reportError($this->getLabel('label-cannot-detect-domain') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" ");return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if ($ve558e63f3083922542d8745224a66eea !== null && $ve558e63f3083922542d8745224a66eea && !$v068ee263b9951356e828019683f53948->getDefaultDomain()) {$v068ee263b9951356e828019683f53948->setDefaultDomain($v72ee76c5c29383b7c9f9225c1fa4d10b);}if ($v66e6283a2d6b70fd594bdf4f315d6074 !== null) {$vad5f82e879a9c5d6b5b442eb37e50551->setUsingSsl($v66e6283a2d6b70fd594bdf4f315d6074);}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domains++;$this->writeLog($this->getLabel('label-domain') . ' "' . $v67b3dba8bc6778101892eb77249db32e . '" (#' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-m'));}elseif ($vad5f82e879a9c5d6b5b442eb37e50551->getIsUpdated()) {$this->updated_domains++;$this->writeLog($this->getLabel('label-domain') . ' "' . $v67b3dba8bc6778101892eb77249db32e . '" (#' . $v3bd920688a19a611654416dbea871efa . ') has been ' . $this->getLabel('label-has-been-updated-m'));}$v9f830dcc1c7ead3b8a335116817baa2d = $v204aadf644884156d194b4fccb7a101a->getElementsByTagName('domain-mirror');foreach ($v9f830dcc1c7ead3b8a335116817baa2d as $ve66673bf13d4f6427125f5380df0ecb7) {$this->importDomainMirror($ve66673bf13d4f6427125f5380df0ecb7, $vad5f82e879a9c5d6b5b442eb37e50551);}$vad5f82e879a9c5d6b5b442eb37e50551->commit();return $vad5f82e879a9c5d6b5b442eb37e50551;}protected function importDomainMirror(DOMElement $ve66673bf13d4f6427125f5380df0ecb7, iDomain $vad5f82e879a9c5d6b5b442eb37e50551) {$v3bd920688a19a611654416dbea871efa = $ve66673bf13d4f6427125f5380df0ecb7->getAttribute('id');$v67b3dba8bc6778101892eb77249db32e = $ve66673bf13d4f6427125f5380df0ecb7->hasAttribute('host') ? $ve66673bf13d4f6427125f5380df0ecb7->getAttribute('host') : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\" " . $this->getLabel('label-with-empty-id'));return false;}$ve2fa538867c3830a859a5b17ab24644b = false;$v13c1f5c5e4829e276308259711c5bd33 = $this->relations->getNewDomainMirrorIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if (!$v13c1f5c5e4829e276308259711c5bd33) {if ($v67b3dba8bc6778101892eb77249db32e !== null) {$v13c1f5c5e4829e276308259711c5bd33 = $vad5f82e879a9c5d6b5b442eb37e50551->getMirrorId($v67b3dba8bc6778101892eb77249db32e);if ($v13c1f5c5e4829e276308259711c5bd33) {$this->relations->setDomainMirrorIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v13c1f5c5e4829e276308259711c5bd33);}}}if ($v13c1f5c5e4829e276308259711c5bd33 && $this->update_ignore) {$this->writeLog($this->getLabel('label-domain') . ' "' . $v67b3dba8bc6778101892eb77249db32e . "\" (#{$v3bd920688a19a611654416dbea871efa}) " . $this->getLabel('label-already-exists'));return $vad5f82e879a9c5d6b5b442eb37e50551->getMirror($v13c1f5c5e4829e276308259711c5bd33);}if (!$v13c1f5c5e4829e276308259711c5bd33) {if ($v67b3dba8bc6778101892eb77249db32e === null) {$v67b3dba8bc6778101892eb77249db32e = $v3bd920688a19a611654416dbea871efa;}$v13c1f5c5e4829e276308259711c5bd33 = $vad5f82e879a9c5d6b5b442eb37e50551->addMirror($v67b3dba8bc6778101892eb77249db32e);$this->relations->setDomainMirrorIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v13c1f5c5e4829e276308259711c5bd33);$ve2fa538867c3830a859a5b17ab24644b = true;}$v95be0a2e6132b4fa2294808f7dbcc52a = $vad5f82e879a9c5d6b5b442eb37e50551->getMirror($v13c1f5c5e4829e276308259711c5bd33);if (!$v95be0a2e6132b4fa2294808f7dbcc52a instanceof iDomainMirror) {$this->reportError($this->getLabel('label-cannot-detect-domain-mirror') . " \"{$v67b3dba8bc6778101892eb77249db32e}\"");return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . ' "' . $v67b3dba8bc6778101892eb77249db32e . '" (#' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-n'));}elseif ($v95be0a2e6132b4fa2294808f7dbcc52a->getIsUpdated()) {$this->updated_domain_mirrors++;$this->writeLog($this->getLabel('label-domain-mirror') . ' "' . $v67b3dba8bc6778101892eb77249db32e . '" (#' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-n'));}return $v95be0a2e6132b4fa2294808f7dbcc52a;}protected function importTemplates() {$vfed36e93a0509e20f2dc96cbbd85b678 = $this->parser->evaluate('/umidump/templates/template');foreach ($vfed36e93a0509e20f2dc96cbbd85b678 as $v01947397aa2c441e93a8f772847d5aca) {$this->importTemplate($v01947397aa2c441e93a8f772847d5aca);}}protected function importTemplate(DOMElement $v01947397aa2c441e93a8f772847d5aca) {$v3bd920688a19a611654416dbea871efa = $v01947397aa2c441e93a8f772847d5aca->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('title') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('title') : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-template') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = templatesCollection::getInstance();$v435ed7e9f07f740abf511a62c00eef6e = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('filename') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('filename') : null;$v7e8b3aa3f998e11a12ea0c3f228ab03f = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('domain-id') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('domain-id') : null;$vfff2750d7f6fe6e8adb4bd98e87b03f5 = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('lang-id') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('lang-id') : null;$ve558e63f3083922542d8745224a66eea = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('is-default') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('is-default') : null;$vb068931cc450442b63f5b3d276ea4297 = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('name') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('name') : null;$v599dcce2998a6b40b1e38e8c6006cb0a = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('type') ? $v01947397aa2c441e93a8f772847d5aca->getAttribute('type') : null;$vf585b7f018bb4ced15a03683a733e50b = false;$v72ee76c5c29383b7c9f9225c1fa4d10b = false;if ($vfff2750d7f6fe6e8adb4bd98e87b03f5 !== null) {$vf585b7f018bb4ced15a03683a733e50b = $this->relations->getNewLangIdRelation($this->source_id, $vfff2750d7f6fe6e8adb4bd98e87b03f5);}if ($v7e8b3aa3f998e11a12ea0c3f228ab03f !== null) {$v72ee76c5c29383b7c9f9225c1fa4d10b = $this->relations->getNewDomainIdRelation($this->source_id, $v7e8b3aa3f998e11a12ea0c3f228ab03f);}if (!$vf585b7f018bb4ced15a03683a733e50b) {$vf585b7f018bb4ced15a03683a733e50b = Service::LanguageCollection()->getDefaultLang()->getId();}if (!$v72ee76c5c29383b7c9f9225c1fa4d10b) {$v72ee76c5c29383b7c9f9225c1fa4d10b = Service::DomainCollection()->getDefaultDomain()->getId();}$ve2fa538867c3830a859a5b17ab24644b = false;$v3200a31fc05da4e9d5a0465c36822e2f = $this->relations->getNewTemplateIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);if ($v3200a31fc05da4e9d5a0465c36822e2f && $this->update_ignore) {$this->writeLog($this->getLabel('label-template') . ' "' . $vd5d3db1765287eef77d7927cc956f50a . "\" (#{$v3bd920688a19a611654416dbea871efa}) " . $this->getLabel('label-already-exists'));return $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v3200a31fc05da4e9d5a0465c36822e2f);}if (!$v3200a31fc05da4e9d5a0465c36822e2f) {if (!$vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $v3bd920688a19a611654416dbea871efa;}$v3200a31fc05da4e9d5a0465c36822e2f = $this->detectTemplateId($v435ed7e9f07f740abf511a62c00eef6e, $v72ee76c5c29383b7c9f9225c1fa4d10b, $vf585b7f018bb4ced15a03683a733e50b);if (!$v3200a31fc05da4e9d5a0465c36822e2f) {$v3200a31fc05da4e9d5a0465c36822e2f = $vdb6d9b451b818ccc9a449383f2f0c450->addTemplate($v435ed7e9f07f740abf511a62c00eef6e, $vd5d3db1765287eef77d7927cc956f50a);}$this->relations->setTemplateIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v3200a31fc05da4e9d5a0465c36822e2f);$ve2fa538867c3830a859a5b17ab24644b = true;}$v66f6181bcb4cff4cd38fbc804a036db6 = $vdb6d9b451b818ccc9a449383f2f0c450->getTemplate($v3200a31fc05da4e9d5a0465c36822e2f);$v86dce043678952b27d5b27a5296f020c = $v01947397aa2c441e93a8f772847d5aca->hasAttribute('install-only') ? (bool) $v01947397aa2c441e93a8f772847d5aca->getAttribute('install-only') : false;if (!$v66f6181bcb4cff4cd38fbc804a036db6 instanceof iTemplate) {$this->reportError($this->getLabel('label-cannot-detect-template') . "\"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if ($ve558e63f3083922542d8745224a66eea !== null) {$v66f6181bcb4cff4cd38fbc804a036db6->setIsDefault($ve558e63f3083922542d8745224a66eea);}if ($vb068931cc450442b63f5b3d276ea4297 !== null) {$v66f6181bcb4cff4cd38fbc804a036db6->setName($vb068931cc450442b63f5b3d276ea4297);}if ($v599dcce2998a6b40b1e38e8c6006cb0a !== null) {$v66f6181bcb4cff4cd38fbc804a036db6->setType($v599dcce2998a6b40b1e38e8c6006cb0a);}$v66f6181bcb4cff4cd38fbc804a036db6->setLangId($vf585b7f018bb4ced15a03683a733e50b);$v66f6181bcb4cff4cd38fbc804a036db6->setDomainId($v72ee76c5c29383b7c9f9225c1fa4d10b);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_templates++;$this->writeLog($this->getLabel('label-template') . ' "' . $vd5d3db1765287eef77d7927cc956f50a . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-m'));}elseif ($v66f6181bcb4cff4cd38fbc804a036db6->getIsUpdated()) {$this->updated_templates++;$this->writeLog($this->getLabel('label-template') . ' "' . $vd5d3db1765287eef77d7927cc956f50a . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-m'));}$v66f6181bcb4cff4cd38fbc804a036db6->commit();return $v66f6181bcb4cff4cd38fbc804a036db6;}protected function importRestrictions() {$v81e12dac658cfd4c590486dd6f7523cf = $this->parser->evaluate('/umidump/restrictions/restriction');foreach ($v81e12dac658cfd4c590486dd6f7523cf as $v37172e3fafb4237c23dfa49f7635984a) {$this->importRestriction($v37172e3fafb4237c23dfa49f7635984a);}}protected function importRestriction(DOMElement $v37172e3fafb4237c23dfa49f7635984a) {$v3bd920688a19a611654416dbea871efa = $v37172e3fafb4237c23dfa49f7635984a->getAttribute('id');$vd5d3db1765287eef77d7927cc956f50a = $v37172e3fafb4237c23dfa49f7635984a->hasAttribute('title') ? $v37172e3fafb4237c23dfa49f7635984a->getAttribute('title') : null;$v851f5ac9941d720844d143ed9cfcf60a = $v37172e3fafb4237c23dfa49f7635984a->hasAttribute('prefix') ? $v37172e3fafb4237c23dfa49f7635984a->getAttribute('prefix') : null;$v870b60148237c1452dfb337fdd19c314 = $v37172e3fafb4237c23dfa49f7635984a->hasAttribute('field-type') ? $v37172e3fafb4237c23dfa49f7635984a->getAttribute('field-type') : null;$vce495ab8d79db0d37413d8e95b54e606 = $v37172e3fafb4237c23dfa49f7635984a->getAttribute('is-multiple') == 1 || $v37172e3fafb4237c23dfa49f7635984a->getAttribute('is-multiple') == 'multiple';if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError($this->getLabel('label-cannot-create-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\" " . $this->getLabel('label-with-empty-id'));return false;}$vdb6d9b451b818ccc9a449383f2f0c450 = umiFieldTypesCollection::getInstance();$v833750ac635fcc57dc33ecafe365f9a7 = $vdb6d9b451b818ccc9a449383f2f0c450->getFieldTypeByDataType($v870b60148237c1452dfb337fdd19c314, $vce495ab8d79db0d37413d8e95b54e606);$v5f694956811487225d15e973ca38fbab = $v833750ac635fcc57dc33ecafe365f9a7->getId();$ve2fa538867c3830a859a5b17ab24644b = false;$v6b1a57fa235477758817df3c91158006 = false;if (!$vd5d3db1765287eef77d7927cc956f50a) {$vd5d3db1765287eef77d7927cc956f50a = $v3bd920688a19a611654416dbea871efa;}if (baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v5f694956811487225d15e973ca38fbab)) {$v6b1a57fa235477758817df3c91158006 = baseRestriction::find($v851f5ac9941d720844d143ed9cfcf60a, $v5f694956811487225d15e973ca38fbab)->getId();if ($v6b1a57fa235477758817df3c91158006 != $this->relations->getNewRestrictionIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa)) {$this->relations->setRestrictionIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v6b1a57fa235477758817df3c91158006);}}if (!$v6b1a57fa235477758817df3c91158006) {$v6b1a57fa235477758817df3c91158006 = $this->relations->getNewRestrictionIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);}if (!$v6b1a57fa235477758817df3c91158006) {$v6b1a57fa235477758817df3c91158006 = baseRestriction::add($v851f5ac9941d720844d143ed9cfcf60a, $vd5d3db1765287eef77d7927cc956f50a, $v5f694956811487225d15e973ca38fbab);$this->relations->setRestrictionIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v6b1a57fa235477758817df3c91158006);$ve2fa538867c3830a859a5b17ab24644b = true;}$v3dadfaeb46ec74762b37de11fea7605c = baseRestriction::get($v6b1a57fa235477758817df3c91158006);$v86dce043678952b27d5b27a5296f020c = $v37172e3fafb4237c23dfa49f7635984a->hasAttribute('install-only') ? (bool) $v37172e3fafb4237c23dfa49f7635984a->getAttribute('install-only') : false;if (!$v3dadfaeb46ec74762b37de11fea7605c instanceof baseRestriction) {$this->reportError($this->getLabel('label-cannot-detect-restriction') . " \"{$vd5d3db1765287eef77d7927cc956f50a}\"");return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_restrictions++;$this->writeLog($this->getLabel('label-restriction') . ' "' . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-n'));}$v2e43aaa89179283bd8e9e43d77b809fe = $v37172e3fafb4237c23dfa49f7635984a->getElementsByTagName('field');foreach ($v2e43aaa89179283bd8e9e43d77b809fe as $v89a2007e7c15e80c35f21ea4a4540700) {$vb5cf8e26a05f5b35fcd36ef010257265 = $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('field-name');$v57304aa3b475b46b53845390fa37c991 = $v89a2007e7c15e80c35f21ea4a4540700->getAttribute('type-id');$v6301cee35ea764a1e241978f93f01069 = $this->relations->getNewTypeIdRelation($this->source_id, $v57304aa3b475b46b53845390fa37c991);if (!$v6301cee35ea764a1e241978f93f01069) {continue;}$v945100186b119048837b9859c2c46410 = umiObjectTypesCollection::getInstance()->getType($v6301cee35ea764a1e241978f93f01069)->getFieldId(self::translateName($vb5cf8e26a05f5b35fcd36ef010257265), false);if (!$v945100186b119048837b9859c2c46410) {umiObjectTypesCollection::getInstance()->getType($v6301cee35ea764a1e241978f93f01069)->getFieldId($vb5cf8e26a05f5b35fcd36ef010257265, false);}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {$this->reportError($this->getLabel('label-cannot-set-restriction-for-field') . " \"{$vb5cf8e26a05f5b35fcd36ef010257265}\": " . $this->getLabel('label-cannot-detect-field'));continue;}$v06e3d36fa30cea095545139854ad1fb9->setRestrictionId($v6b1a57fa235477758817df3c91158006);$v06e3d36fa30cea095545139854ad1fb9->setIsUpdated();$this->writeLog($this->getLabel('label-restriction') . ' "' . $v3dadfaeb46ec74762b37de11fea7605c->getTitle() . '" ' . $this->getLabel('label-has-been-set-for-field') . " \"{$vb5cf8e26a05f5b35fcd36ef010257265}\"");}return $v3dadfaeb46ec74762b37de11fea7605c;}protected function importRegistry() {$v14f802e1fba977727845e8872c1743a7 = $this->parser->evaluate('/umidump/registry/key');foreach ($v14f802e1fba977727845e8872c1743a7 as $v4440c59bedd6c4ec74875425a6666bd8) {$this->importReg($v4440c59bedd6c4ec74875425a6666bd8);}}protected function importReg(DOMElement $v4440c59bedd6c4ec74875425a6666bd8) {$vd6fe1d0be6347b8ef2427fa629c04485 = $v4440c59bedd6c4ec74875425a6666bd8->hasAttribute('path') ? $v4440c59bedd6c4ec74875425a6666bd8->getAttribute('path') : null;if (!$vd6fe1d0be6347b8ef2427fa629c04485) {$this->reportError($this->getLabel('label-cannot-create-registry-item-with-empty-path'));return false;}$v2063c1608d6e0baf80249c42e2be5804 = $v4440c59bedd6c4ec74875425a6666bd8->hasAttribute('val') ? $v4440c59bedd6c4ec74875425a6666bd8->getAttribute('val') : null;$v16501dd19601e7ef2aa421bf34585f73 = $v4440c59bedd6c4ec74875425a6666bd8->hasAttribute('update');$ve2fa538867c3830a859a5b17ab24644b = false;$v0f81d52e06caaa4860887488d18271c7 = false;$v2dd0aa7597bc38ed6d3993ec5872f445 = Service::Registry();if (!$v2dd0aa7597bc38ed6d3993ec5872f445->contains($vd6fe1d0be6347b8ef2427fa629c04485)) {$v2dd0aa7597bc38ed6d3993ec5872f445->set($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804);$ve2fa538867c3830a859a5b17ab24644b = true;}elseif ($v16501dd19601e7ef2aa421bf34585f73) {$v2dd0aa7597bc38ed6d3993ec5872f445->set($vd6fe1d0be6347b8ef2427fa629c04485, $v2063c1608d6e0baf80249c42e2be5804);$v0f81d52e06caaa4860887488d18271c7 = true;}if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_registry_items++;$this->writeLog($this->getLabel('label-registry-item') . ' "' . $vd6fe1d0be6347b8ef2427fa629c04485 . '" (' . $v2063c1608d6e0baf80249c42e2be5804 . ') ' . $this->getLabel('label-has-been-created-f'));}elseif ($v0f81d52e06caaa4860887488d18271c7) {$this->writeLog('Registry item "' . $vd6fe1d0be6347b8ef2427fa629c04485 . '" (' . $v2063c1608d6e0baf80249c42e2be5804 . ') has been updated');}}protected function importTypeRelation(iUmiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vf03ad9e4ebc731946c49a47a1a26925d, iUmiObjectType $v599dcce2998a6b40b1e38e8c6006cb0a) {$v82b3bf9585b0fb3bf67bb34c769b7e91 = $vf03ad9e4ebc731946c49a47a1a26925d->getElementsByTagName('guide');$v1fbc4766c1fcbaf3f14c4b76a5ca05a1 = $v82b3bf9585b0fb3bf67bb34c769b7e91->length ? $v82b3bf9585b0fb3bf67bb34c769b7e91->item(0)->getAttribute('id') : false;$v52eb29c6d8ea0d3a5bb3654f49bbd7c7 = $this->relations->getNewTypeIdRelation($this->source_id, $v1fbc4766c1fcbaf3f14c4b76a5ca05a1);if (!$v52eb29c6d8ea0d3a5bb3654f49bbd7c7) {return false;}if ($v06e3d36fa30cea095545139854ad1fb9->getGuideId() != $v52eb29c6d8ea0d3a5bb3654f49bbd7c7) {$v06e3d36fa30cea095545139854ad1fb9->setGuideId($v52eb29c6d8ea0d3a5bb3654f49bbd7c7);$this->updated_relations++;$this->writeLog($this->getLabel('label-relation') . ': ' . $this->getLabel('label-datatype') . ' (' . $v599dcce2998a6b40b1e38e8c6006cb0a->getName() . ') - ' . $this->getLabel('label-field') . ' (' . $v06e3d36fa30cea095545139854ad1fb9->getName() . ') - ' . $this->getLabel('label-guide') . " ({$v52eb29c6d8ea0d3a5bb3654f49bbd7c7}) " . $this->getLabel('label-has-been-updated-f'));$v06e3d36fa30cea095545139854ad1fb9->commit();}return true;}protected function importEntityRelation(iUmiField $v06e3d36fa30cea095545139854ad1fb9, DOMElement $vf03ad9e4ebc731946c49a47a1a26925d, $vf5e638cc78dd325906c1298a0c21fb6b) {$v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getName();$v9602dd5efeb5e02a7e5f213e91c017a7 = [];foreach ($vf03ad9e4ebc731946c49a47a1a26925d->getElementsByTagName('object') as $vbfb9b1cd25f05560dfdda8bca7dac185) {$vab3bb1a616c225b159f33ef1de49779d = $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('id');$v16b2b26000987faccb260b9d39df1269 = (int) $this->relations->getNewObjectIdRelation($this->source_id, $vab3bb1a616c225b159f33ef1de49779d);if ($v16b2b26000987faccb260b9d39df1269) {$v9602dd5efeb5e02a7e5f213e91c017a7[] = $v16b2b26000987faccb260b9d39df1269;}}$vbf95cbea2fbc6aab956a058a7afb3e45 = [];foreach ($vf03ad9e4ebc731946c49a47a1a26925d->getElementsByTagName('page') as $v77f3c48f175369c446fbe421012437c2) {$vc32f93b97487df243397614496865136 = $v77f3c48f175369c446fbe421012437c2->getAttribute('id');$va6eb4816205178e88dad66a16a19ff45 = (int) $this->relations->getNewIdRelation($this->source_id, $vc32f93b97487df243397614496865136);if ($va6eb4816205178e88dad66a16a19ff45) {$vbf95cbea2fbc6aab956a058a7afb3e45[] = $va6eb4816205178e88dad66a16a19ff45;}}$v0f81d52e06caaa4860887488d18271c7 = false;$vb1b26d9d245655a2cf8422f066203b2a = $vf5e638cc78dd325906c1298a0c21fb6b->getId();$v5a2576254d428ddc22a03fac145c8749 = $v9602dd5efeb5e02a7e5f213e91c017a7 ?: $vbf95cbea2fbc6aab956a058a7afb3e45;if (umiCount($v5a2576254d428ddc22a03fac145c8749) > 0) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v972bf3f05d14ffbdb817bef60638ff00, $v5a2576254d428ddc22a03fac145c8749);$this->updated_relations++;$v0f81d52e06caaa4860887488d18271c7 = true;}else {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v972bf3f05d14ffbdb817bef60638ff00, []);}if ($v0f81d52e06caaa4860887488d18271c7) {if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObject) {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v972bf3f05d14ffbdb817bef60638ff00}) " . $this->getLabel('label-of-object') . " ({$vb1b26d9d245655a2cf8422f066203b2a}) " . $this->getLabel('label-have-been-updated'));}else {$this->writeLog($this->getLabel('label-values-for-field') . " ({$v972bf3f05d14ffbdb817bef60638ff00}) " . $this->getLabel('label-of-page') . " ({$vb1b26d9d245655a2cf8422f066203b2a}) " . $this->getLabel('label-have-been-updated'));}}$vf5e638cc78dd325906c1298a0c21fb6b->commit();if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObject) {umiObjectsCollection::getInstance()->unloadObject($vb1b26d9d245655a2cf8422f066203b2a);}else {umiHierarchy::getInstance()->unloadElement($vb1b26d9d245655a2cf8422f066203b2a);}return true;}protected function importRelations() {$v06c5b10273a69992d8c6933e294909fa = $this->parser->evaluate('/umidump/relations/relation');foreach ($v06c5b10273a69992d8c6933e294909fa as $vf03ad9e4ebc731946c49a47a1a26925d) {$this->importRelation($vf03ad9e4ebc731946c49a47a1a26925d);}}protected function importRelation(DOMElement $vf03ad9e4ebc731946c49a47a1a26925d) {$v506213e108aa2d8a53dce233d3ead162 = $vf03ad9e4ebc731946c49a47a1a26925d->hasAttribute('type-id') ? $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('type-id') : null;$vae18952384bd351bec233801e256a902 = $vf03ad9e4ebc731946c49a47a1a26925d->hasAttribute('page-id') ? $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('page-id') : null;$v64e17a1299a4e6867ddf991da07d8275 = $vf03ad9e4ebc731946c49a47a1a26925d->hasAttribute('object-id') ? $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('object-id') : null;$vb5cf8e26a05f5b35fcd36ef010257265 = $vf03ad9e4ebc731946c49a47a1a26925d->hasAttribute('field-name') ? $vf03ad9e4ebc731946c49a47a1a26925d->getAttribute('field-name') : null;if (!$v506213e108aa2d8a53dce233d3ead162 && !$vae18952384bd351bec233801e256a902 && !$v64e17a1299a4e6867ddf991da07d8275) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$vb5cf8e26a05f5b35fcd36ef010257265}\":" . $this->getLabel('label-cannot-detect-entity'));return false;}$v5f694956811487225d15e973ca38fbab = null;$vf5e638cc78dd325906c1298a0c21fb6b = null;if ($v506213e108aa2d8a53dce233d3ead162 !== null) {$v5f694956811487225d15e973ca38fbab = $this->relations->getNewTypeIdRelation($this->source_id, $v506213e108aa2d8a53dce233d3ead162);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectTypesCollection::getInstance()->getType($v5f694956811487225d15e973ca38fbab);}elseif ($vae18952384bd351bec233801e256a902 !== null) {$va6eb4816205178e88dad66a16a19ff45 = $this->relations->getNewIdRelation($this->source_id, $vae18952384bd351bec233801e256a902);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($va6eb4816205178e88dad66a16a19ff45, true, true);}elseif ($v64e17a1299a4e6867ddf991da07d8275 !== null) {$v16b2b26000987faccb260b9d39df1269 = $this->relations->getNewObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($v16b2b26000987faccb260b9d39df1269);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-relation-for-field') . " \"{$vb5cf8e26a05f5b35fcd36ef010257265}\": " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiHierarchyElement) {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();}elseif ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObject) {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();}$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v5f694956811487225d15e973ca38fbab);$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId(self::translateName($vb5cf8e26a05f5b35fcd36ef010257265), false);if (!$v945100186b119048837b9859c2c46410) {$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb5cf8e26a05f5b35fcd36ef010257265, false);}if (!$v945100186b119048837b9859c2c46410) {return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObjectType) {return $this->importTypeRelation($v06e3d36fa30cea095545139854ad1fb9, $vf03ad9e4ebc731946c49a47a1a26925d, $vf5e638cc78dd325906c1298a0c21fb6b);}return $this->importEntityRelation($v06e3d36fa30cea095545139854ad1fb9, $vf03ad9e4ebc731946c49a47a1a26925d, $vf5e638cc78dd325906c1298a0c21fb6b);}protected function importPermissions() {$permissions = $this->parser->evaluate('/umidump/permissions/permission');foreach ($permissions as $v3eab20b6b92c5ab57d985694bf131c51) {$this->importPermission($v3eab20b6b92c5ab57d985694bf131c51);}}protected function importPermission(DOMElement $v3eab20b6b92c5ab57d985694bf131c51) {$vae18952384bd351bec233801e256a902 = $v3eab20b6b92c5ab57d985694bf131c51->hasAttribute('page-id') ? $v3eab20b6b92c5ab57d985694bf131c51->getAttribute('page-id') : null;$v64e17a1299a4e6867ddf991da07d8275 = $v3eab20b6b92c5ab57d985694bf131c51->hasAttribute('object-id') ? $v3eab20b6b92c5ab57d985694bf131c51->getAttribute('object-id') : null;if (!$vae18952384bd351bec233801e256a902 && !$v64e17a1299a4e6867ddf991da07d8275) {$this->reportError($this->getLabel('label-cannot-create-permission') . ': ' . $this->getLabel('label-cannot-detect-entity'));return false;}$permissions = permissionsCollection::getInstance();$vf5e638cc78dd325906c1298a0c21fb6b = null;if ($vae18952384bd351bec233801e256a902 !== null) {$va6eb4816205178e88dad66a16a19ff45 = $this->relations->getNewIdRelation($this->source_id, $vae18952384bd351bec233801e256a902);$vf5e638cc78dd325906c1298a0c21fb6b = umiHierarchy::getInstance()->getElement($va6eb4816205178e88dad66a16a19ff45, true, true);}elseif ($v64e17a1299a4e6867ddf991da07d8275 !== null) {$vaf31437ce61345f416579830a98c91e5 = $this->relations->getNewObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275);$vf5e638cc78dd325906c1298a0c21fb6b = umiObjectsCollection::getInstance()->getObject($vaf31437ce61345f416579830a98c91e5);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-permission') . ': ' . $this->getLabel('label-cannot-detect-entity'));return false;}$vb1b26d9d245655a2cf8422f066203b2a = $vf5e638cc78dd325906c1298a0c21fb6b->getId();$v461bbedf241df49f480943665af58f59 = $v3eab20b6b92c5ab57d985694bf131c51->getElementsByTagName('owner');foreach ($v461bbedf241df49f480943665af58f59 as $v7437f43390ef2a19140ea6bf0aa6a7a4) {$v1c86f8f55830f26cbe524ed8972ec6d8 = $v7437f43390ef2a19140ea6bf0aa6a7a4->getAttribute('id');$vb0ab4f7791b60b1e8ea01057b77873b0 = (int) $this->relations->getNewObjectIdRelation($this->source_id, $v1c86f8f55830f26cbe524ed8972ec6d8);$vc9e9a848920877e76685b2e4e76de38d = $v7437f43390ef2a19140ea6bf0aa6a7a4->hasAttribute('level') ? $v7437f43390ef2a19140ea6bf0aa6a7a4->getAttribute('level') : null;if ($vc9e9a848920877e76685b2e4e76de38d !== null) {$permissions->setElementPermissions($vb0ab4f7791b60b1e8ea01057b77873b0, $vb1b26d9d245655a2cf8422f066203b2a, $vc9e9a848920877e76685b2e4e76de38d);$this->created_permissions++;}else {$vf5e638cc78dd325906c1298a0c21fb6b->setOwnerId($vb0ab4f7791b60b1e8ea01057b77873b0);$vf5e638cc78dd325906c1298a0c21fb6b->setIsUpdated();$vf5e638cc78dd325906c1298a0c21fb6b->commit();$this->writeLog($this->getLabel('label-owner-for-entity') . ' (' . $vb1b26d9d245655a2cf8422f066203b2a . ') ' . $this->getLabel('label-has-been-updated-m'));$this->created_permissions++;}}$v3e05c9f1c48ba7f9a67721643390dd85 = $v3eab20b6b92c5ab57d985694bf131c51->getElementsByTagName('module');if ($v3e05c9f1c48ba7f9a67721643390dd85->length == 0) {return;}$v60cccb9a8e7818ae4213f78608875a15 = $permissions->hasUserModulesPermissions($vb1b26d9d245655a2cf8422f066203b2a);foreach ($v3e05c9f1c48ba7f9a67721643390dd85 as $v22884db148f0ffb0d830ba431102b0b5) {if ($v22884db148f0ffb0d830ba431102b0b5->hasAttribute('install-only') && $v60cccb9a8e7818ae4213f78608875a15) {continue;}$v52a43e48ec4649dee819dadabcab1bde = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('name');$vea9f6aca279138c58f705c8d4cb4b8ce = $v22884db148f0ffb0d830ba431102b0b5->getAttribute('method');if ($vea9f6aca279138c58f705c8d4cb4b8ce) {if (!$permissions->isAllowedMethod($vb1b26d9d245655a2cf8422f066203b2a, $v52a43e48ec4649dee819dadabcab1bde, $vea9f6aca279138c58f705c8d4cb4b8ce)) {$permissions->setModulesPermissions($vb1b26d9d245655a2cf8422f066203b2a, $v52a43e48ec4649dee819dadabcab1bde, $vea9f6aca279138c58f705c8d4cb4b8ce);$this->writeLog($this->getLabel('label-permissions-for') . ' ' . $this->getLabel('label-module') . " \"{$v52a43e48ec4649dee819dadabcab1bde}\" - " . $this->getLabel('label-method') . " \"{$vea9f6aca279138c58f705c8d4cb4b8ce}\" " . $this->getLabel('label-of-object') . ' (' . $vb1b26d9d245655a2cf8422f066203b2a . ') ' . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}else {if (!$permissions->isAllowedModule($vb1b26d9d245655a2cf8422f066203b2a, $v52a43e48ec4649dee819dadabcab1bde)) {$permissions->setModulesPermissions($vb1b26d9d245655a2cf8422f066203b2a, $v52a43e48ec4649dee819dadabcab1bde);$this->writeLog($this->getLabel('label-permissions-for') . ' ' . $this->getLabel('label-module') . " \"{$v52a43e48ec4649dee819dadabcab1bde}\" " . $this->getLabel('label-of-object') . ' (' . $vb1b26d9d245655a2cf8422f066203b2a . ') ' . $this->getLabel('label-have-been-updated'));$this->created_permissions++;}}}}protected function importOptions() {$v93da65a9fd0004d9477aeac024e08e15 = $this->parser->evaluate('/umidump/options/entity');foreach ($v93da65a9fd0004d9477aeac024e08e15 as $v904392a19930b5c35e97bfd3c4dac307) {$this->importOption($v904392a19930b5c35e97bfd3c4dac307);}}protected function importOption(DOMElement $v904392a19930b5c35e97bfd3c4dac307) {$vae18952384bd351bec233801e256a902 = $v904392a19930b5c35e97bfd3c4dac307->hasAttribute('page-id') ? $v904392a19930b5c35e97bfd3c4dac307->getAttribute('page-id') : null;$v64e17a1299a4e6867ddf991da07d8275 = $v904392a19930b5c35e97bfd3c4dac307->hasAttribute('object-id') ? $v904392a19930b5c35e97bfd3c4dac307->getAttribute('object-id') : null;$vb5cf8e26a05f5b35fcd36ef010257265 = $v904392a19930b5c35e97bfd3c4dac307->hasAttribute('field-name') ? $v904392a19930b5c35e97bfd3c4dac307->getAttribute('field-name') : null;if (!$vae18952384bd351bec233801e256a902 && !$v64e17a1299a4e6867ddf991da07d8275) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$vb5cf8e26a05f5b35fcd36ef010257265} " . $this->getLabel('label-cannot-detect-entity'));return false;}$vf5e638cc78dd325906c1298a0c21fb6b = null;$v475d6424dac268bb5fffd0235530c333 = umiHierarchy::getInstance();$v22df6b77ddb3d4a444fba472a24b327d = umiObjectsCollection::getInstance();if ($vae18952384bd351bec233801e256a902 !== null) {$va6eb4816205178e88dad66a16a19ff45 = $this->relations->getNewIdRelation($this->source_id, $vae18952384bd351bec233801e256a902);$vf5e638cc78dd325906c1298a0c21fb6b = $v475d6424dac268bb5fffd0235530c333->getElement($va6eb4816205178e88dad66a16a19ff45, true, true);}elseif ($v64e17a1299a4e6867ddf991da07d8275 !== null) {$v16b2b26000987faccb260b9d39df1269 = $this->relations->getNewObjectIdRelation($this->source_id, $v64e17a1299a4e6867ddf991da07d8275);$vf5e638cc78dd325906c1298a0c21fb6b = $v22df6b77ddb3d4a444fba472a24b327d->getObject($v16b2b26000987faccb260b9d39df1269);}if (!$vf5e638cc78dd325906c1298a0c21fb6b) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$vb5cf8e26a05f5b35fcd36ef010257265} " . $this->getLabel('label-cannot-detect-entity'));return false;}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiHierarchyElement) {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();}elseif ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiObject) {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();}$v599dcce2998a6b40b1e38e8c6006cb0a = umiObjectTypesCollection::getInstance()->getType($v5f694956811487225d15e973ca38fbab);$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId(self::translateName($vb5cf8e26a05f5b35fcd36ef010257265), false);if (!$v945100186b119048837b9859c2c46410) {$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb5cf8e26a05f5b35fcd36ef010257265, false);}if (!$v945100186b119048837b9859c2c46410) {$this->reportError($this->getLabel('label-cannot-create-options-for-field') . " {$vb5cf8e26a05f5b35fcd36ef010257265} " . $this->getLabel('label-cannot-detect-field'));return false;}$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);$v972bf3f05d14ffbdb817bef60638ff00 = $v06e3d36fa30cea095545139854ad1fb9->getName();$vf5e638cc78dd325906c1298a0c21fb6b->setValue($v972bf3f05d14ffbdb817bef60638ff00, $this->getOptionValue($v904392a19930b5c35e97bfd3c4dac307));$vf5e638cc78dd325906c1298a0c21fb6b->commit();}private function getOptionValue(DOMElement $v904392a19930b5c35e97bfd3c4dac307) {$v475d6424dac268bb5fffd0235530c333 = umiHierarchy::getInstance();$v22df6b77ddb3d4a444fba472a24b327d = umiObjectsCollection::getInstance();$v993fcb1e163e40a45771f626d3ea0f0f = [];foreach ($this->parser->evaluate('option', $v904392a19930b5c35e97bfd3c4dac307) as $vc3660ff61995c9ac9ac147882e39bb2e) {if (!$vc3660ff61995c9ac9ac147882e39bb2e->hasAttributes()) {continue;}$v2063c1608d6e0baf80249c42e2be5804 = [];foreach ($vc3660ff61995c9ac9ac147882e39bb2e->attributes as $vd2eb444e35c0a71f0a85df8194acb5b6) {if ($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'object-id') {$v16b2b26000987faccb260b9d39df1269 = $this->relations->getNewObjectIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$v16b2b26000987faccb260b9d39df1269) {continue;}$vb068931cc450442b63f5b3d276ea4297 = $v22df6b77ddb3d4a444fba472a24b327d->getObject($v16b2b26000987faccb260b9d39df1269)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}elseif ($vd2eb444e35c0a71f0a85df8194acb5b6->name == 'page-id') {$va6eb4816205178e88dad66a16a19ff45 = $this->relations->getNewIdRelation($this->source_id, $vd2eb444e35c0a71f0a85df8194acb5b6->value);if (!$va6eb4816205178e88dad66a16a19ff45) {continue;}$vb068931cc450442b63f5b3d276ea4297 = $v475d6424dac268bb5fffd0235530c333->getElement($va6eb4816205178e88dad66a16a19ff45, true, true)->getName();$v2063c1608d6e0baf80249c42e2be5804['rel'] = $vb068931cc450442b63f5b3d276ea4297;}else {$v2063c1608d6e0baf80249c42e2be5804[$vd2eb444e35c0a71f0a85df8194acb5b6->name] = $vd2eb444e35c0a71f0a85df8194acb5b6->value;}}$v993fcb1e163e40a45771f626d3ea0f0f[] = $v2063c1608d6e0baf80249c42e2be5804;}return $v993fcb1e163e40a45771f626d3ea0f0f;}protected function importFiles() {$v45b963397aa40d4a0063e0d85e4fe7a1 = $this->parser->evaluate('/umidump/files/file');foreach ($v45b963397aa40d4a0063e0d85e4fe7a1 as $v3ded0fa90fac2901571c95109308f187) {$this->importFile($v3ded0fa90fac2901571c95109308f187);}}protected function importFile(DOMElement $v3ded0fa90fac2901571c95109308f187) {$v435ed7e9f07f740abf511a62c00eef6e = $v3ded0fa90fac2901571c95109308f187->hasAttribute('name') ? $v3ded0fa90fac2901571c95109308f187->getAttribute('name') : null;$v58bf60f0a0a0c2a570550b595104b692 = $v3ded0fa90fac2901571c95109308f187->hasAttribute('hash') ? $v3ded0fa90fac2901571c95109308f187->getAttribute('hash') : null;$v857d5dae818a37d6732ac1faff247168 = $v3ded0fa90fac2901571c95109308f187->nodeValue;if (!$v857d5dae818a37d6732ac1faff247168) {$this->reportError($this->getLabel('label-cannot-create-file-with-empty-path'));return false;}$v857d5dae818a37d6732ac1faff247168 = $this->getRootDirPath() . $v857d5dae818a37d6732ac1faff247168;$va06276a5d4dfec1460f81219fda03a37 = dirname($v857d5dae818a37d6732ac1faff247168);if (!file_exists($va06276a5d4dfec1460f81219fda03a37)) {mkdir($va06276a5d4dfec1460f81219fda03a37, 0777, true);}$vba1383ce0ab1b09b605e4c7010356023 = $this->filesSource . $v3ded0fa90fac2901571c95109308f187->nodeValue;if (!file_exists($vba1383ce0ab1b09b605e4c7010356023)) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-does-not-exist'));return false;}if (copy($vba1383ce0ab1b09b605e4c7010356023, $v857d5dae818a37d6732ac1faff247168)) {$v8f607eb9228346c32b2b217c1545c710 = md5_file($v857d5dae818a37d6732ac1faff247168);if ($v58bf60f0a0a0c2a570550b595104b692 != $v8f607eb9228346c32b2b217c1545c710) {$this->reportError($this->getLabel('label-file') . " {$v435ed7e9f07f740abf511a62c00eef6e} " . $this->getLabel('label-is-broken'));}else {if (defined('PHP_FILES_ACCESS_MODE') && mb_strtolower(mb_substr($v857d5dae818a37d6732ac1faff247168, -4, 4)) === '.php') {chmod($v857d5dae818a37d6732ac1faff247168, PHP_FILES_ACCESS_MODE);}$this->copied_files++;$this->writeLog($this->getLabel('label-file') . ' "' . $v435ed7e9f07f740abf511a62c00eef6e . '" (' . $v857d5dae818a37d6732ac1faff247168 . ') ' . $this->getLabel('label-has-been-copied-m'));}}else {$this->reportError($this->getLabel('label-cannot-copy-file') . " \"{$v435ed7e9f07f740abf511a62c00eef6e}\"");}}protected function importDirs() {$vbd1e333d1166f18893b2bbeba10229a3 = $this->parser->evaluate('/umidump/directories/directory');foreach ($vbd1e333d1166f18893b2bbeba10229a3 as $v5ad71e29dde7915da6a5874921360908) {$this->importDir($v5ad71e29dde7915da6a5874921360908);}}protected function importDir(DOMElement $v5ad71e29dde7915da6a5874921360908) {$vb068931cc450442b63f5b3d276ea4297 = $v5ad71e29dde7915da6a5874921360908->hasAttribute('name') ? $v5ad71e29dde7915da6a5874921360908->getAttribute('name') : null;$vd6fe1d0be6347b8ef2427fa629c04485 = $v5ad71e29dde7915da6a5874921360908->hasAttribute('path') ? $v5ad71e29dde7915da6a5874921360908->getAttribute('path') : null;if ($vd6fe1d0be6347b8ef2427fa629c04485 === null) {$this->reportError($this->getLabel('label-cannot-create-folder-with-empty-path'));return false;}$vd6fe1d0be6347b8ef2427fa629c04485 = $this->getRootDirPath() . $v5ad71e29dde7915da6a5874921360908->nodeValue;if (!file_exists($vd6fe1d0be6347b8ef2427fa629c04485)) {mkdir($vd6fe1d0be6347b8ef2427fa629c04485, 0777, true);$this->created_dirs++;$this->writeLog($this->getLabel('label-folder') . ' "' . $vb068931cc450442b63f5b3d276ea4297 . '" (' . $vd6fe1d0be6347b8ef2427fa629c04485 . ') ' . $this->getLabel('label-has-been-created-f'));}}protected function importObjects() {$v5891da2d64975cae48d175d1e001f5da = $this->parser->evaluate('/umidump/objects/object');foreach ($v5891da2d64975cae48d175d1e001f5da as $vbfb9b1cd25f05560dfdda8bca7dac185) {$this->importObject($vbfb9b1cd25f05560dfdda8bca7dac185);}}protected function importObject(DOMElement $vbfb9b1cd25f05560dfdda8bca7dac185) {$v3bd920688a19a611654416dbea871efa = $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('id');$v1e0ca5b1252f1f6b1e0ac91be7e7219e = $vbfb9b1cd25f05560dfdda8bca7dac185->hasAttribute('guid') ? $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('guid') : null;$vb068931cc450442b63f5b3d276ea4297 = $vbfb9b1cd25f05560dfdda8bca7dac185->hasAttribute('name') ? $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('name') : null;if (!$v3bd920688a19a611654416dbea871efa) {$this->reportError("Can't create object {$vb068931cc450442b63f5b3d276ea4297} with empty id");return false;}$v506213e108aa2d8a53dce233d3ead162 = $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('type-id');$v6e313761a5b0e74c268b15a1ba391784 = $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('update-only') == '1';$v73b8754d45983f35756b157ea439de8c = $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('locked');$v22df6b77ddb3d4a444fba472a24b327d = umiObjectsCollection::getInstance();$v8988aed53b6f4f4932b092de09f31980 = umiObjectTypesCollection::getInstance();$ve2fa538867c3830a859a5b17ab24644b = false;$v16b2b26000987faccb260b9d39df1269 = false;if ($v1e0ca5b1252f1f6b1e0ac91be7e7219e !== null) {$v16b2b26000987faccb260b9d39df1269 = $v22df6b77ddb3d4a444fba472a24b327d->getObjectIdByGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);if ($v16b2b26000987faccb260b9d39df1269 && $v16b2b26000987faccb260b9d39df1269 != $this->relations->getNewObjectIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa)) {$this->relations->setObjectIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v16b2b26000987faccb260b9d39df1269);}}if (!$v16b2b26000987faccb260b9d39df1269) {$v16b2b26000987faccb260b9d39df1269 = $this->relations->getNewObjectIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa);}if ($v16b2b26000987faccb260b9d39df1269 && $this->update_ignore) {$this->writeLog($this->getLabel('label-object') . ' "' . $vb068931cc450442b63f5b3d276ea4297 . "\" (#{$v3bd920688a19a611654416dbea871efa}) " . $this->getLabel('label-already-exists'));return $v22df6b77ddb3d4a444fba472a24b327d->getObject($v16b2b26000987faccb260b9d39df1269);}if (!$v16b2b26000987faccb260b9d39df1269) {if ($v6e313761a5b0e74c268b15a1ba391784) {return false;}if (!$vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = $v3bd920688a19a611654416dbea871efa;}if (!$v506213e108aa2d8a53dce233d3ead162) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v3bd920688a19a611654416dbea871efa}): " . $this->getLabel('label-cannot-detect-type'));return false;}$v5f694956811487225d15e973ca38fbab = $this->relations->getNewTypeIdRelation($this->source_id, $v506213e108aa2d8a53dce233d3ead162);$v599dcce2998a6b40b1e38e8c6006cb0a = $v8988aed53b6f4f4932b092de09f31980->getType($v5f694956811487225d15e973ca38fbab);if (!$v599dcce2998a6b40b1e38e8c6006cb0a instanceof iUmiObjectType) {$this->reportError($this->getLabel('label-cannot-create-object') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" (#{$v3bd920688a19a611654416dbea871efa}): " . $this->getLabel('label-cannot-detect-type') . " #{$v506213e108aa2d8a53dce233d3ead162}");return false;}if ($this->demosite_mode) {$vacf567c9c3d6cf7c6e2cc0ce108e0631 = $v599dcce2998a6b40b1e38e8c6006cb0a->getHierarchyTypeId();if ($vacf567c9c3d6cf7c6e2cc0ce108e0631) {$v89b0b9deff65f8b9cd1f71bc74ce36ba = umiHierarchyTypesCollection::getInstance()->getType($vacf567c9c3d6cf7c6e2cc0ce108e0631);if ($v89b0b9deff65f8b9cd1f71bc74ce36ba instanceof iUmiHierarchyType) {$v22884db148f0ffb0d830ba431102b0b5 = $v89b0b9deff65f8b9cd1f71bc74ce36ba->getModule();if (!Service::Registry()->get("//modules/{$v22884db148f0ffb0d830ba431102b0b5}")) {return false;}}}}$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnAddObject');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('before');$v4119639092e62c55ea8be348e4d9260d->setParam('old_object_id', $v3bd920688a19a611654416dbea871efa);$v4119639092e62c55ea8be348e4d9260d->setParam('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$v4119639092e62c55ea8be348e4d9260d->setParam('type', $v599dcce2998a6b40b1e38e8c6006cb0a);$v4119639092e62c55ea8be348e4d9260d->addRef('old_object_id', $v3bd920688a19a611654416dbea871efa);$v4119639092e62c55ea8be348e4d9260d->addRef('name', $vb068931cc450442b63f5b3d276ea4297);$v4119639092e62c55ea8be348e4d9260d->addRef('type_id', $v5f694956811487225d15e973ca38fbab);$v4119639092e62c55ea8be348e4d9260d->addRef('is_locked', $v73b8754d45983f35756b157ea439de8c);$v4119639092e62c55ea8be348e4d9260d->addRef('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);$v16b2b26000987faccb260b9d39df1269 = $v22df6b77ddb3d4a444fba472a24b327d->addObject($vb068931cc450442b63f5b3d276ea4297, $v5f694956811487225d15e973ca38fbab, $v73b8754d45983f35756b157ea439de8c == 'locked' || $v73b8754d45983f35756b157ea439de8c == '1');$this->relations->setObjectIdRelation($this->source_id, $v3bd920688a19a611654416dbea871efa, $v16b2b26000987faccb260b9d39df1269);$ve2fa538867c3830a859a5b17ab24644b = true;}$va8cfde6331bd59eb2ac96f8911c4b666 = $v22df6b77ddb3d4a444fba472a24b327d->getObject($v16b2b26000987faccb260b9d39df1269);$v86dce043678952b27d5b27a5296f020c = $vbfb9b1cd25f05560dfdda8bca7dac185->hasAttribute('install-only') ? (bool) $vbfb9b1cd25f05560dfdda8bca7dac185->getAttribute('install-only') : false;if (!$va8cfde6331bd59eb2ac96f8911c4b666 instanceof iUmiObject) {return false;}if ($v86dce043678952b27d5b27a5296f020c && !$ve2fa538867c3830a859a5b17ab24644b) {return false;}if (!$ve2fa538867c3830a859a5b17ab24644b) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnUpdateObject');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('before');$v4119639092e62c55ea8be348e4d9260d->addRef('object', $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setParam('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$v4119639092e62c55ea8be348e4d9260d->addRef('guid', $v1e0ca5b1252f1f6b1e0ac91be7e7219e);$v4119639092e62c55ea8be348e4d9260d->addRef('name', $vb068931cc450442b63f5b3d276ea4297);$v4119639092e62c55ea8be348e4d9260d->addRef('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}if ($v1e0ca5b1252f1f6b1e0ac91be7e7219e !== null) {$va8cfde6331bd59eb2ac96f8911c4b666->setGUID($v1e0ca5b1252f1f6b1e0ac91be7e7219e);}if ($vb068931cc450442b63f5b3d276ea4297 !== null) {$va8cfde6331bd59eb2ac96f8911c4b666->setName($vb068931cc450442b63f5b3d276ea4297);}$this->importPropValues($va8cfde6331bd59eb2ac96f8911c4b666, $vbfb9b1cd25f05560dfdda8bca7dac185, $ve2fa538867c3830a859a5b17ab24644b);if ($ve2fa538867c3830a859a5b17ab24644b) {$this->created_objects++;$this->writeLog($this->getLabel('label-object') . ' "' . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-created-m'));}elseif ($va8cfde6331bd59eb2ac96f8911c4b666->getIsUpdated()) {$this->updated_objects++;$this->writeLog($this->getLabel('label-object') . ' "' . $va8cfde6331bd59eb2ac96f8911c4b666->getName() . '" (' . $v3bd920688a19a611654416dbea871efa . ') ' . $this->getLabel('label-has-been-updated-m'));}if ($ve2fa538867c3830a859a5b17ab24644b) {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnAddObject');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->addRef('object', $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setParam('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}else {$v4119639092e62c55ea8be348e4d9260d = new umiEventPoint('exchangeOnUpdateObject');$v4119639092e62c55ea8be348e4d9260d->setParam('source_id', $this->source_id);$v4119639092e62c55ea8be348e4d9260d->setMode('after');$v4119639092e62c55ea8be348e4d9260d->addRef('object', $va8cfde6331bd59eb2ac96f8911c4b666);$v4119639092e62c55ea8be348e4d9260d->setParam('object_info', $vbfb9b1cd25f05560dfdda8bca7dac185);$this->callEvent($v4119639092e62c55ea8be348e4d9260d);}$va8cfde6331bd59eb2ac96f8911c4b666->commit();$v22df6b77ddb3d4a444fba472a24b327d->unloadObject($v16b2b26000987faccb260b9d39df1269);return $va8cfde6331bd59eb2ac96f8911c4b666;}private function callEvent(iUmiEventPoint $v4119639092e62c55ea8be348e4d9260d) {if ($this->isEventsEnabled()) {umiEventsController::getInstance()     ->callEvent($v4119639092e62c55ea8be348e4d9260d);}}private function isEventsEnabled() {return $this->eventsEnabled;}protected static function translateName($vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = umiHierarchy::convertAltName($vb068931cc450442b63f5b3d276ea4297, '_');$vb068931cc450442b63f5b3d276ea4297 = umiObjectProperty::filterInputString($vb068931cc450442b63f5b3d276ea4297);if (!$vb068931cc450442b63f5b3d276ea4297) {$vb068931cc450442b63f5b3d276ea4297 = '_';}$vb068931cc450442b63f5b3d276ea4297 = mb_substr($vb068931cc450442b63f5b3d276ea4297, 0, 64);return $vb068931cc450442b63f5b3d276ea4297;}protected function importPropValues(iUmiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $v904392a19930b5c35e97bfd3c4dac307, $v9fa5c9f55420ce88938ef14f6e0d5f95 = false) {$v74693d2fc58b46bd06410f278e39aa71 = $this->parser->evaluate('properties/group/property', $v904392a19930b5c35e97bfd3c4dac307);foreach ($v74693d2fc58b46bd06410f278e39aa71 as $v96b8eeb9e337bd8704b337b404d62688) {try {$this->importPropValue($vf5e638cc78dd325906c1298a0c21fb6b, $v96b8eeb9e337bd8704b337b404d62688, $v9fa5c9f55420ce88938ef14f6e0d5f95);}catch (Exception $ve1671797c52e15f763380b45e841ec32) {$this->writeLog("Can't set value #" . $vf5e638cc78dd325906c1298a0c21fb6b->getId() . '.' . $v904392a19930b5c35e97bfd3c4dac307->getAttribute('name') . ': ' . $ve1671797c52e15f763380b45e841ec32->getMessage());}}}protected function importPropValue($vf5e638cc78dd325906c1298a0c21fb6b, DOMElement $v96b8eeb9e337bd8704b337b404d62688, $v9fa5c9f55420ce88938ef14f6e0d5f95 = false) {$v185289923ff2879738c10b282fd25371 = $v96b8eeb9e337bd8704b337b404d62688->getAttribute('name');$vb068931cc450442b63f5b3d276ea4297 = self::translateName($v185289923ff2879738c10b282fd25371);$v1e01655c8149c2ec8aa9fbb6de411fab = $this->parser->evaluate('value', $v96b8eeb9e337bd8704b337b404d62688);if (!$v1e01655c8149c2ec8aa9fbb6de411fab->length && $v9fa5c9f55420ce88938ef14f6e0d5f95) {$v1e01655c8149c2ec8aa9fbb6de411fab = $this->parser->evaluate('default-value', $v96b8eeb9e337bd8704b337b404d62688);}if (!$v1e01655c8149c2ec8aa9fbb6de411fab->length) {if ($v9fa5c9f55420ce88938ef14f6e0d5f95) {$this->reportError($this->getLabel('label-property') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" " . $this->getLabel('label-has-no-values'));}return false;}$vf390d9ed4004a4e088e29464c661f362 = $v1e01655c8149c2ec8aa9fbb6de411fab->item(0);if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiHierarchyElement) {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getObjectTypeId();}else {$v5f694956811487225d15e973ca38fbab = $vf5e638cc78dd325906c1298a0c21fb6b->getTypeId();}$v8988aed53b6f4f4932b092de09f31980 = umiObjectTypesCollection::getInstance();$v599dcce2998a6b40b1e38e8c6006cb0a = $v8988aed53b6f4f4932b092de09f31980->getType($v5f694956811487225d15e973ca38fbab);$v945100186b119048837b9859c2c46410 = $v599dcce2998a6b40b1e38e8c6006cb0a->getFieldId($vb068931cc450442b63f5b3d276ea4297, false);$v06e3d36fa30cea095545139854ad1fb9 = umiFieldsCollection::getInstance()->getField($v945100186b119048837b9859c2c46410);if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField && $v96b8eeb9e337bd8704b337b404d62688->getAttribute('allow-runtime-add') == '1') {$v2e847b4bdd51143b305f4f5ad6691d5f = $v96b8eeb9e337bd8704b337b404d62688->parentNode;$v42adb88cec4f42f03968e4b6489d1487 = $this->importTypeGroup($v599dcce2998a6b40b1e38e8c6006cb0a, $v2e847b4bdd51143b305f4f5ad6691d5f, false);if (empty($v42adb88cec4f42f03968e4b6489d1487)) {return false;}foreach ($v42adb88cec4f42f03968e4b6489d1487 as $v68e435576960d83c891fcb5072d73497 => $v47db2588331bbe530c80dd001fc60aed) {$v19223bd3731a4215ead3ba6a1eb8bbe8 = $v8988aed53b6f4f4932b092de09f31980->getType($v68e435576960d83c891fcb5072d73497);if (!$v19223bd3731a4215ead3ba6a1eb8bbe8 instanceof iUmiObjectType) {continue;}$v22fc2bf44a9332c31b099fed5432c44f = true;$vdb0f6f37ebeb6ea09489124345af2a45 = $v19223bd3731a4215ead3ba6a1eb8bbe8->getFieldsGroup($v47db2588331bbe530c80dd001fc60aed, $v22fc2bf44a9332c31b099fed5432c44f);if (!$vdb0f6f37ebeb6ea09489124345af2a45 instanceof iUmiFieldsGroup) {$v8988aed53b6f4f4932b092de09f31980->unloadType($v68e435576960d83c891fcb5072d73497);continue;}$v06e3d36fa30cea095545139854ad1fb9 = $this->importField($vdb0f6f37ebeb6ea09489124345af2a45, $v96b8eeb9e337bd8704b337b404d62688);$v8988aed53b6f4f4932b092de09f31980->unloadType($v68e435576960d83c891fcb5072d73497);}if ($vf5e638cc78dd325906c1298a0c21fb6b->getIsUpdated()) {$vf5e638cc78dd325906c1298a0c21fb6b->commit();}if ($vf5e638cc78dd325906c1298a0c21fb6b instanceof iUmiHierarchyElement) {$vf5e638cc78dd325906c1298a0c21fb6b->getObject()->update();}else {$vf5e638cc78dd325906c1298a0c21fb6b->update();}}if (!$v06e3d36fa30cea095545139854ad1fb9 instanceof iUmiField) {return false;}switch ($v06e3d36fa30cea095545139854ad1fb9->getDataType()) {case 'optioned':    case 'symlink': {return false;}case 'date': {$vd7e6d55ba379a13d08c25d15faf2a23b = (int) $vf390d9ed4004a4e088e29464c661f362->getAttribute('unix-timestamp');$v5fc732311905cb27e82d67f4f6511f7f = new umiDate();if ($vd7e6d55ba379a13d08c25d15faf2a23b) {$v5fc732311905cb27e82d67f4f6511f7f->setDateByTimeStamp($vd7e6d55ba379a13d08c25d15faf2a23b);}else {$v5fc732311905cb27e82d67f4f6511f7f->setDateByString($vf390d9ed4004a4e088e29464c661f362->nodeValue);}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v5fc732311905cb27e82d67f4f6511f7f);break;}case 'price': {$this->importPriceValue($vf5e638cc78dd325906c1298a0c21fb6b, $vb068931cc450442b63f5b3d276ea4297, $vf390d9ed4004a4e088e29464c661f362);break;}case 'file':    case 'img_file':    case 'video_file':    case 'swf_file': {if ($this->renameFiles) {$v9d22547e12eafcfadf56ff88b9d67f4d = false;$vf83cd85f6404a7018af0fcf071f35751 = $vf5e638cc78dd325906c1298a0c21fb6b->getValue($vb068931cc450442b63f5b3d276ea4297);if ($vf83cd85f6404a7018af0fcf071f35751 instanceof umiFile) {$v9d22547e12eafcfadf56ff88b9d67f4d = $vf83cd85f6404a7018af0fcf071f35751->getFilePath();}$vbf0e61d0f411b035bf846149824fe352 = ltrim(trim($vf390d9ed4004a4e088e29464c661f362->nodeValue, "\r\n"), '.');$v435ed7e9f07f740abf511a62c00eef6e = basename($vbf0e61d0f411b035bf846149824fe352);$v736007832d2167baaae763fd3a3f3cf1 = dirname($vbf0e61d0f411b035bf846149824fe352);$vabf77184f55403d75b9d51d79162a7ca = explode('.', $v435ed7e9f07f740abf511a62c00eef6e);$vabf77184f55403d75b9d51d79162a7ca = end($vabf77184f55403d75b9d51d79162a7ca);$vd70819bac4952f91adc9954c5b055aca = translit::convert(trim($vf5e638cc78dd325906c1298a0c21fb6b->getName(), "\r\n"));$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca;$ve2942a04780e223b215eb8b663cf5353 = 0;$v3193aefb53bd30e851ba8172785ce214 = error_reporting(0);while (true) {if (!file_exists($this->getRootDirPath() . '/' . $vbf0e61d0f411b035bf846149824fe352)) {break 2;}if ($v9d22547e12eafcfadf56ff88b9d67f4d) {$v46cd4eff50a3aca89f0fbc7ea6a79453 = $this->getRootDirPath() . ltrim($v9d22547e12eafcfadf56ff88b9d67f4d, '.');if (file_exists($v46cd4eff50a3aca89f0fbc7ea6a79453)) {unlink($v46cd4eff50a3aca89f0fbc7ea6a79453);}}if (!file_exists($this->getRootDirPath() . '/' . $v736007832d2167baaae763fd3a3f3cf1 . '/' . $v435ed7e9f07f740abf511a62c00eef6e . '.' . $vabf77184f55403d75b9d51d79162a7ca)) {break;}$ve2942a04780e223b215eb8b663cf5353++;$v435ed7e9f07f740abf511a62c00eef6e = $vd70819bac4952f91adc9954c5b055aca . '_' . $ve2942a04780e223b215eb8b663cf5353;}$v435ed7e9f07f740abf511a62c00eef6e .= '.' . $vabf77184f55403d75b9d51d79162a7ca;rename($this->getRootDirPath() . '/' . $vbf0e61d0f411b035bf846149824fe352, $this->getRootDirPath() . '/' . $v736007832d2167baaae763fd3a3f3cf1 . '/' . $v435ed7e9f07f740abf511a62c00eef6e);error_reporting($v3193aefb53bd30e851ba8172785ce214);$vbf0e61d0f411b035bf846149824fe352 = '.' . $v736007832d2167baaae763fd3a3f3cf1 . '/' . $v435ed7e9f07f740abf511a62c00eef6e;$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $vbf0e61d0f411b035bf846149824fe352);}else {$v47826cacc65c665212b821e6ff80b9b0 = ltrim(trim($vf390d9ed4004a4e088e29464c661f362->nodeValue, "\r\n"), '.');$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, '.' . $v47826cacc65c665212b821e6ff80b9b0);}break;}case 'relation': {if ($this->auto_guide_creation) {if ($vb068931cc450442b63f5b3d276ea4297 == 'payment_status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43 instanceof emarket) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v903931b3a9d25a70683f51ab9d363d2e = $vf390d9ed4004a4e088e29464c661f362->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->getId());if ($v70a17ffa722a3985b86d30b034ad06d7 instanceof order) {$v70a17ffa722a3985b86d30b034ad06d7->setPaymentStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}}elseif ($vb068931cc450442b63f5b3d276ea4297 == 'status_id' && $v599dcce2998a6b40b1e38e8c6006cb0a->getMethod() == 'order') {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()->getModule('emarket');if ($vfcaea7edd270964cc145ea48e4367d43 instanceof emarket) {$v903931b3a9d25a70683f51ab9d363d2e = $vf390d9ed4004a4e088e29464c661f362->nodeValue;$v70a17ffa722a3985b86d30b034ad06d7 = order::get($vf5e638cc78dd325906c1298a0c21fb6b->getId());if ($v70a17ffa722a3985b86d30b034ad06d7 instanceof order) {$v46cbdabcc8b11ae9fd02ac1e854b63a6 = $v70a17ffa722a3985b86d30b034ad06d7->getOrderStatus();$vd47852e1e74d95f48b35f0c036477af1 = $v70a17ffa722a3985b86d30b034ad06d7->getCodeByStatus($v46cbdabcc8b11ae9fd02ac1e854b63a6);if (!in_array($vd47852e1e74d95f48b35f0c036477af1, ['ready', 'canceled', 'rejected'])) {umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = false;$v70a17ffa722a3985b86d30b034ad06d7->setOrderStatus($v903931b3a9d25a70683f51ab9d363d2e);$v70a17ffa722a3985b86d30b034ad06d7->commit();umiObjectProperty::$USE_FORCE_OBJECTS_CREATION = true;}}}}else {$v691d502cfd0e0626cd3b058e5682ad1c = [];$v4286560a0f2b34cf2b3d7e658673c613 = $vf390d9ed4004a4e088e29464c661f362->getElementsByTagName('item');foreach ($v4286560a0f2b34cf2b3d7e658673c613 as $v399a75af3a8a951a74e76f096d19233b) {$v691d502cfd0e0626cd3b058e5682ad1c[] = $v399a75af3a8a951a74e76f096d19233b->getAttribute('name');}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v691d502cfd0e0626cd3b058e5682ad1c);}}break;}case 'tags': {$v5df986bc14af33e630d925cb5d55fb63 = $this->parser->evaluate('combined', $v96b8eeb9e337bd8704b337b404d62688);$vf390d9ed4004a4e088e29464c661f362 = $v5df986bc14af33e630d925cb5d55fb63->item(0);if ($vf390d9ed4004a4e088e29464c661f362) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($vf390d9ed4004a4e088e29464c661f362->nodeValue, "\r\n"));}break;}case 'link_to_object_type': {$v7f7cfde5ec586119b48911a2c75851e5 = $this->relations->getNewTypeIdRelation($this->source_id, $vf390d9ed4004a4e088e29464c661f362->nodeValue);if (is_numeric($v7f7cfde5ec586119b48911a2c75851e5)) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, (int) $v7f7cfde5ec586119b48911a2c75851e5);}else {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, (int) $vf390d9ed4004a4e088e29464c661f362->nodeValue);}break;}case 'domain_id': {$v8acf8f6caf4016af8e9fb1f2b97167e3 = $vf390d9ed4004a4e088e29464c661f362->getElementsByTagName('domain');if ($v8acf8f6caf4016af8e9fb1f2b97167e3->length == 0) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, null);break;}$v32a9d3c9a4b1449499e182e90d04fcc9 = $v8acf8f6caf4016af8e9fb1f2b97167e3->item(0)->getAttribute('id');$v1c043be0eed6949c174fcf4359f7c601 = $this->relations->getNewDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9);if (is_int($v1c043be0eed6949c174fcf4359f7c601)) {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v1c043be0eed6949c174fcf4359f7c601);}elseif(Service::DomainCollection()->isExists($v32a9d3c9a4b1449499e182e90d04fcc9)) {$this->relations->setDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9, $v32a9d3c9a4b1449499e182e90d04fcc9);$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v32a9d3c9a4b1449499e182e90d04fcc9);}else {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, null);}break;}case 'domain_id_list': {$v993fcb1e163e40a45771f626d3ea0f0f = [];foreach ($vf390d9ed4004a4e088e29464c661f362->getElementsByTagName('domain') as $v204aadf644884156d194b4fccb7a101a) {$v32a9d3c9a4b1449499e182e90d04fcc9 = $v204aadf644884156d194b4fccb7a101a->getAttribute('id');if (!$v32a9d3c9a4b1449499e182e90d04fcc9) {continue;}$v1c043be0eed6949c174fcf4359f7c601 = $this->relations->getNewDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9);if (is_int($v1c043be0eed6949c174fcf4359f7c601)) {$v993fcb1e163e40a45771f626d3ea0f0f[] = $v1c043be0eed6949c174fcf4359f7c601;}elseif(Service::DomainCollection()->isExists($v32a9d3c9a4b1449499e182e90d04fcc9)) {$this->relations->setDomainIdRelation($this->source_id, $v32a9d3c9a4b1449499e182e90d04fcc9, $v32a9d3c9a4b1449499e182e90d04fcc9);$v993fcb1e163e40a45771f626d3ea0f0f[] = $v32a9d3c9a4b1449499e182e90d04fcc9;}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v993fcb1e163e40a45771f626d3ea0f0f);break;}case 'multiple_image': {$v993fcb1e163e40a45771f626d3ea0f0f = [];foreach ($v1e01655c8149c2ec8aa9fbb6de411fab as $v57e30a65c210fd2d6da648f0ca3fc90c) {if (!$v57e30a65c210fd2d6da648f0ca3fc90c->hasAttribute('path')) {$this->reportError($this->getLabel('label-property') . " \"{$vb068931cc450442b63f5b3d276ea4297}\" " . $this->getLabel('label-has-no-values'));continue;}$v47826cacc65c665212b821e6ff80b9b0 = $v57e30a65c210fd2d6da648f0ca3fc90c->getAttribute('path');$v78805a221a988e79ef3f42d7c5bfd418 = new umiImageFile($v47826cacc65c665212b821e6ff80b9b0);if ($v57e30a65c210fd2d6da648f0ca3fc90c->hasAttribute('id')) {$v78805a221a988e79ef3f42d7c5bfd418->setId($v57e30a65c210fd2d6da648f0ca3fc90c->getAttribute('id'));}if ($v57e30a65c210fd2d6da648f0ca3fc90c->hasAttribute('alt')) {$v78805a221a988e79ef3f42d7c5bfd418->setAlt($v57e30a65c210fd2d6da648f0ca3fc90c->getAttribute('alt'));}if ($v57e30a65c210fd2d6da648f0ca3fc90c->hasAttribute('ord')) {$v78805a221a988e79ef3f42d7c5bfd418->setOrder($v57e30a65c210fd2d6da648f0ca3fc90c->getAttribute('ord'));}$v993fcb1e163e40a45771f626d3ea0f0f[$v78805a221a988e79ef3f42d7c5bfd418->getFilePath()] = $v78805a221a988e79ef3f42d7c5bfd418;}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v993fcb1e163e40a45771f626d3ea0f0f);break;}case 'string':    case 'text':    case 'wysiwyg':    case 'boolean':    case 'counter':    case 'float':    case 'color':    case 'int':    default: {$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, trim($vf390d9ed4004a4e088e29464c661f362->nodeValue, "\r\n"));break;}}}private function importPriceValue(iUmiEntinty $vf5e638cc78dd325906c1298a0c21fb6b, $vb068931cc450442b63f5b3d276ea4297, DOMElement $vf390d9ed4004a4e088e29464c661f362) {$vfcaea7edd270964cc145ea48e4367d43 = cmsController::getInstance()    ->getModule('emarket');$v78a5eb43deef9a7b5b9ce157b9d52ac4 = $vf390d9ed4004a4e088e29464c661f362->nodeValue;$v78a5eb43deef9a7b5b9ce157b9d52ac4 = str_replace(',', '.', $v78a5eb43deef9a7b5b9ce157b9d52ac4);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = (float) preg_replace('/[^0-9.,]/', '', $v78a5eb43deef9a7b5b9ce157b9d52ac4);$vc13367945d5d4c91047b3b50234aa7ab = $vf390d9ed4004a4e088e29464c661f362->getAttribute($vf390d9ed4004a4e088e29464c661f362->hasAttribute('currency-code') ? 'currency-code' : 'currency_code');if ($vfcaea7edd270964cc145ea48e4367d43 instanceof emarket) {$v7f24d9fc4140045241b3f97bcf36bf03 = $vfcaea7edd270964cc145ea48e4367d43->getCurrencyFacade();try {$v1af0389838508d7016a9841eb6273962 = $v7f24d9fc4140045241b3f97bcf36bf03->getByCode($vc13367945d5d4c91047b3b50234aa7ab);$ve7f82a9e3265341d89499a8a0efaa995 = $v7f24d9fc4140045241b3f97bcf36bf03->getDefault();$result = $vfcaea7edd270964cc145ea48e4367d43->formatCurrencyPrice([$v78a5eb43deef9a7b5b9ce157b9d52ac4], $ve7f82a9e3265341d89499a8a0efaa995, $v1af0389838508d7016a9841eb6273962);$v78a5eb43deef9a7b5b9ce157b9d52ac4 = isset($result[0]) ? $result[0] : 0;}catch (privateException $v42552b1f133f9f8eb406d4f306ea9fd1) {}}$vf5e638cc78dd325906c1298a0c21fb6b->setValue($vb068931cc450442b63f5b3d276ea4297, $v78a5eb43deef9a7b5b9ce157b9d52ac4);}private function getRootDirPath() {if ($this->rootDirPath !== null) {return $this->rootDirPath;}return $this->rootDirPath = CURRENT_WORKING_DIR;}private function importEntities() {$v1a3c00ce27b98ca3fc020990b28f62c1 = Service::ImportEntitySourceIdBinderFactory()    ->create($this->source_id);$va4a25203bf0a0dea6590e40f1704f825 = new xmlEntityImporter($this->parser, $v1a3c00ce27b98ca3fc020990b28f62c1);$result = $va4a25203bf0a0dea6590e40f1704f825->import();$this->created_entities += $result['created'];$this->updated_entities += $result['updated'];foreach ($result['log'] as $v78e731027d8fd50ed642340b7c9a63b3) {$this->writeLog($v78e731027d8fd50ed642340b7c9a63b3);}foreach ($result['errors'] as $vd83a5a8080de341e6551f42e0feece88) {$this->reportError($vd83a5a8080de341e6551f42e0feece88);}}}